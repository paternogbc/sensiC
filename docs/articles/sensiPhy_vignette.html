<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>sensiPhy: R-package for sensitivity analysis in phylogenetic comparative methods. • sensiPhy</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="sensiPhy: R-package for sensitivity analysis in phylogenetic comparative methods.">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">sensiPhy</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.8.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/sensiPhy_vignette.html">sensiPhy: R-package for sensitivity analysis in phylogenetic comparative methods.</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/paternogbc/sensiPhy">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>sensiPhy: R-package for sensitivity analysis in phylogenetic comparative methods.</h1>
                        <h4 class="author">Gustavo Paterno, Caterina Penone, Gijsbert Werner</h4>
            
            <h4 class="date">2020-04-01</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/paternogbc/sensiPhy/blob/master/vignettes/sensiPhy_vignette.Rmd"><code>vignettes/sensiPhy_vignette.Rmd</code></a></small>
      <div class="hidden name"><code>sensiPhy_vignette.Rmd</code></div>

    </div>

    
    
<p>##<strong>Introduction to sensiPhy</strong> The <strong>sensiPhy</strong> package provides simple functions to perform sensitivity analyses in phylogenetic comparative methods. It uses several simulation methods to estimate the impact of different types of uncertainty on Phylogenetic comparative methods:</p>
<ol style="list-style-type: lower-roman">
<li>Species Sampling uncertainty (sample size; influential species and clades)</li>
<li>Phylogenetic uncertainty</li>
<li>Data uncertainty (intraspecific variation and measurement error)</li>
</ol>
<p><strong>Functions for sensitivity analysis</strong></p>
<p>sensiPhy functions use a common syntax that combines the type of uncertainty and the type of analysis:</p>
<ul>
<li>xxx_<strong>phylm</strong> (for linear regressions)</li>
<li>xxx_<strong>phyglm</strong> (for logistic regressions)</li>
<li>xxx_<strong>physig</strong> (for phylogenetic signal)</li>
<li>xxx_<strong>continuous</strong> (for continuous trait evolution)</li>
<li>xxx_<strong>discrete</strong> (for discrete trait evolution)</li>
</ul>
<p>where “xxx” can be one of the 5 sensiPhy methods (see Figure below):</p>
<ul>
<li>
<strong>Species sampling uncertainty</strong>: influ; clade; samp;</li>
<li>
<strong>Phylogenetic uncertainty</strong>: tree</li>
<li>
<strong>Data uncertainty</strong>: intra</li>
</ul>
<p><strong>sensiPhy</strong> workflow &amp; functions</p>
<p><img src="../../../../../Ci%C3%AAncia/github/A1_Rpackages/sensiPhy/vignettes/sensiPhy_workflow_functions.png" width="700px"></p>
<p><strong>Additional functions</strong></p>
<ul>
<li>
<strong>match_dataPhy</strong>: Match data and phylogeny based on model formula</li>
<li>
<strong>miss.phylo.d</strong>: Calculate the phylogenetic signal for missing data</li>
<li>
<strong>tree.bd</strong>: Tree diversification and speciation with phylogenetic uncertainty</li>
</ul>
<div id="sampling-uncertainty" class="section level2">
<h2 class="hasAnchor">
<a href="#sampling-uncertainty" class="anchor"></a>1. Sampling uncertainty</h2>
<div id="sensitivity-analysis-for-influential-species" class="section level3">
<h3 class="hasAnchor">
<a href="#sensitivity-analysis-for-influential-species" class="anchor"></a>1.1 Sensitivity analysis for influential species</h3>
<p>The <code>influ</code> method performs leave-one-out deletion analysis and detects influential species on parameter estimates.</p>
<div id="influ_phylm-phylogenetic-linear-regression" class="section level5">
<h5 class="hasAnchor">
<a href="#influ_phylm-phylogenetic-linear-regression" class="anchor"></a>1.1.1 influ_phylm(): Phylogenetic linear regression</h5>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(sensiPhy)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="co"># run analysis:</span></a>
<a class="sourceLine" id="cb1-3" data-line-number="3">influ &lt;-<span class="st"> </span><span class="kw"><a href="../reference/influ_phylm.html">influ_phylm</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(gestaLen) <span class="op">~</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(adultMass), <span class="dt">phy =</span> alien<span class="op">$</span>phy[[<span class="dv">1</span>]], </a>
<a class="sourceLine" id="cb1-4" data-line-number="4">                     <span class="dt">data =</span> alien<span class="op">$</span>data, <span class="dt">track=</span><span class="ot">FALSE</span>)</a></code></pre></div>
<p>Note that <code>track = TRUE</code> shows the progress of the analysis</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="co"># To check summary results:</span></a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(influ)</a>
<a class="sourceLine" id="cb2-3" data-line-number="3"></a>
<a class="sourceLine" id="cb2-4" data-line-number="4"><span class="co"># Most influential species</span></a>
<a class="sourceLine" id="cb2-5" data-line-number="5">influ<span class="op">$</span>influential.species</a>
<a class="sourceLine" id="cb2-6" data-line-number="6"></a>
<a class="sourceLine" id="cb2-7" data-line-number="7"><span class="co"># Visual diagnostics</span></a>
<a class="sourceLine" id="cb2-8" data-line-number="8"><span class="kw"><a href="../reference/sensi_plot.html">sensi_plot</a></span>(influ)</a></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="co"># Check most influential species on the original regression plot:</span></a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="kw"><a href="../reference/sensi_plot.html">sensi_plot</a></span>(influ, <span class="dt">graphs =</span> <span class="dv">2</span>)</a></code></pre></div>
</div>
<div id="influ_physig-phylogenetic-signal" class="section level5">
<h5 class="hasAnchor">
<a href="#influ_physig-phylogenetic-signal" class="anchor"></a>1.1.2. influ_physig(): Phylogenetic signal</h5>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="co"># Logtransform data</span></a>
<a class="sourceLine" id="cb4-2" data-line-number="2">alien.data<span class="op">$</span>logMass &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(alien.data<span class="op">$</span>adultMass)</a>
<a class="sourceLine" id="cb4-3" data-line-number="3"><span class="co"># Run sensitivity analysis:</span></a>
<a class="sourceLine" id="cb4-4" data-line-number="4">influ &lt;-<span class="st"> </span><span class="kw"><a href="../reference/influ_physig.html">influ_physig</a></span>(<span class="st">"logMass"</span>, <span class="dt">data =</span> alien.data, <span class="dt">phy =</span> alien.phy[[<span class="dv">1</span>]], <span class="dt">track=</span><span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb4-5" data-line-number="5"><span class="co"># You can change the method used to estimate signal:</span></a>
<a class="sourceLine" id="cb4-6" data-line-number="6">influ2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/influ_physig.html">influ_physig</a></span>(<span class="st">"logMass"</span>, <span class="dt">data =</span> alien.data, <span class="dt">phy =</span> alien.phy[[<span class="dv">1</span>]], <span class="dt">method =</span> <span class="st">"lambda"</span>, <span class="dt">track=</span><span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb4-7" data-line-number="7"></a>
<a class="sourceLine" id="cb4-8" data-line-number="8"><span class="co"># To check summary results:</span></a>
<a class="sourceLine" id="cb4-9" data-line-number="9"><span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(influ)</a>
<a class="sourceLine" id="cb4-10" data-line-number="10"><span class="co"># Most influential speciesL</span></a>
<a class="sourceLine" id="cb4-11" data-line-number="11">influ<span class="op">$</span>influential.species</a>
<a class="sourceLine" id="cb4-12" data-line-number="12"><span class="co"># Visual diagnostics</span></a>
<a class="sourceLine" id="cb4-13" data-line-number="13"><span class="kw"><a href="../reference/sensi_plot.html">sensi_plot</a></span>(influ)</a>
<a class="sourceLine" id="cb4-14" data-line-number="14"><span class="kw"><a href="../reference/sensi_plot.html">sensi_plot</a></span>(influ2)</a></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="co"># You can specify which graph to print:</span></a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="kw"><a href="../reference/sensi_plot.html">sensi_plot</a></span>(influ, <span class="dt">graphs =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb5-3" data-line-number="3"><span class="kw"><a href="../reference/sensi_plot.html">sensi_plot</a></span>(influ2, <span class="dt">graphs =</span> <span class="dv">1</span>)</a></code></pre></div>
</div>
<div id="influ_continuous-and-influ_discrete-trait-evolution-continuous-and-discrete-characters" class="section level5">
<h5 class="hasAnchor">
<a href="#influ_continuous-and-influ_discrete-trait-evolution-continuous-and-discrete-characters" class="anchor"></a>1.1.3 influ_continuous() and influ_discrete: Trait Evolution Continuous and Discrete Characters</h5>
<p><strong>Continuous characters</strong></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="co"># Load data:</span></a>
<a class="sourceLine" id="cb6-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="st">"primates"</span>)</a>
<a class="sourceLine" id="cb6-3" data-line-number="3"><span class="co"># Model trait evolution accounting for influential species</span></a>
<a class="sourceLine" id="cb6-4" data-line-number="4">adultMass&lt;-primates<span class="op">$</span>data<span class="op">$</span>adultMass</a>
<a class="sourceLine" id="cb6-5" data-line-number="5"><span class="kw"><a href="https://rdrr.io/r/base/names.html">names</a></span>(adultMass)&lt;-<span class="kw"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(primates<span class="op">$</span>data)</a>
<a class="sourceLine" id="cb6-6" data-line-number="6"><span class="co"># Model trait evolution accounting for influential species</span></a>
<a class="sourceLine" id="cb6-7" data-line-number="7">influ_cont&lt;-<span class="kw"><a href="../reference/influ_continuous.html">influ_continuous</a></span>(<span class="dt">data =</span> adultMass,<span class="dt">phy =</span> primates<span class="op">$</span>phy[[<span class="dv">1</span>]],</a>
<a class="sourceLine" id="cb6-8" data-line-number="8"><span class="dt">model =</span> <span class="st">"OU"</span>,<span class="dt">cutoff =</span> <span class="dv">2</span>,<span class="dt">n.cores =</span> <span class="dv">2</span>,<span class="dt">track =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb6-9" data-line-number="9"><span class="co"># Print summary statistics for the transitions rates, aic-values and (if applicable) </span></a>
<a class="sourceLine" id="cb6-10" data-line-number="10"><span class="co"># optimisation parameter</span></a>
<a class="sourceLine" id="cb6-11" data-line-number="11"><span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(influ_cont)</a>
<a class="sourceLine" id="cb6-12" data-line-number="12"><span class="co"># Visual diagnostics</span></a>
<a class="sourceLine" id="cb6-13" data-line-number="13"><span class="kw"><a href="../reference/sensi_plot.html">sensi_plot</a></span>(influ_cont)</a></code></pre></div>
<p>Different evolutionary models from <code>fitContinuous</code> can be used: <code>BM</code>,<code>OU</code>, <code>EB</code>, <code>trend</code>, <code>lambda</code>, <code>kappa</code>, <code>delta</code> and <code>drift</code>.</p>
<p><strong>Discrete characters</strong></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="co"># Load data:</span></a>
<a class="sourceLine" id="cb7-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="st">"primates"</span>)</a>
<a class="sourceLine" id="cb7-3" data-line-number="3"></a>
<a class="sourceLine" id="cb7-4" data-line-number="4"><span class="co"># Create a binary trait factor </span></a>
<a class="sourceLine" id="cb7-5" data-line-number="5">adultMass_binary&lt;-<span class="kw"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span>(primates<span class="op">$</span>data<span class="op">$</span>adultMass <span class="op">&gt;</span><span class="st"> </span><span class="dv">7350</span>, <span class="st">"big"</span>, <span class="st">"small"</span>)</a>
<a class="sourceLine" id="cb7-6" data-line-number="6">adultMass_binary&lt;-<span class="kw"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(adultMass_binary))</a>
<a class="sourceLine" id="cb7-7" data-line-number="7"><span class="kw"><a href="https://rdrr.io/r/base/names.html">names</a></span>(adultMass_binary)&lt;-<span class="kw"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(primates<span class="op">$</span>data)</a>
<a class="sourceLine" id="cb7-8" data-line-number="8"></a>
<a class="sourceLine" id="cb7-9" data-line-number="9"><span class="co"># Model trait evolution accounting for influential species - symmetric model</span></a>
<a class="sourceLine" id="cb7-10" data-line-number="10">influ_binary &lt;-<span class="st"> </span><span class="kw"><a href="../reference/influ_discrete.html">influ_discrete</a></span>(<span class="dt">data =</span> adultMass_binary, <span class="dt">phy =</span> primates<span class="op">$</span>phy[[<span class="dv">1</span>]],</a>
<a class="sourceLine" id="cb7-11" data-line-number="11"><span class="dt">model =</span> <span class="st">"SYM"</span>, <span class="dt">transform =</span> <span class="st">"none"</span>, <span class="dt">cutoff =</span> <span class="dv">2</span>, <span class="dt">n.cores =</span> <span class="dv">2</span>, <span class="dt">track =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb7-12" data-line-number="12"></a>
<a class="sourceLine" id="cb7-13" data-line-number="13"><span class="co"># Print summary statistics for the transition rates, aic-values and </span></a>
<a class="sourceLine" id="cb7-14" data-line-number="14"><span class="co"># (if applicable) optimisation parameter</span></a>
<a class="sourceLine" id="cb7-15" data-line-number="15"><span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(influ_binary)</a>
<a class="sourceLine" id="cb7-16" data-line-number="16"></a>
<a class="sourceLine" id="cb7-17" data-line-number="17"><span class="co"># Visual diagnostics - in symmetrical model q12 and q21 are, as expected, </span></a>
<a class="sourceLine" id="cb7-18" data-line-number="18"><span class="co"># exactly the same </span></a>
<a class="sourceLine" id="cb7-19" data-line-number="19"><span class="kw"><a href="../reference/sensi_plot.html">sensi_plot</a></span>(influ_binary)</a></code></pre></div>
<p>Different character models from <code>fitDiscrete</code> can be fit by changing the <code>model</code> argument. These include <code>ER</code> (equal-rates), <code>SYM</code> (symmetric), <code>ARD</code> (all-rates-different) and <code>meristic</code> (stepwise fashion). Similarly, all transformations to the phylogenetic tree from <code>fitDiscrete</code> can be used: <code>none</code>, <code>EB</code>, <code>lambda</code>, <code>kappa</code> and <code>delta</code>.</p>
</div>
</div>
<div id="sensitivity-analysis-for-influential-clades" class="section level3">
<h3 class="hasAnchor">
<a href="#sensitivity-analysis-for-influential-clades" class="anchor"></a>1.2. Sensitivity analysis for influential clades</h3>
<p>The <code>clade</code> method can be used to estimate and test the influence of specific clades on parameter estimates.</p>
<div id="clade_phylm-phylogenetic-linear-regression" class="section level5">
<h5 class="hasAnchor">
<a href="#clade_phylm-phylogenetic-linear-regression" class="anchor"></a>1.2.1 clade_phylm(): Phylogenetic linear regression</h5>
<p>Additional arguments: <strong>clade.col</strong>: The name of a column in the provided data frame with clades specification (a character vector with clade names). <strong>n.species</strong>: Minimum number of species in the clade in order to include this clade in the leave-one-out deletion analysis. Default is 5. <strong>n.sim</strong>: The number of repetitions for the randomization test</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(primates)</a>
<a class="sourceLine" id="cb8-2" data-line-number="2"><span class="co"># run analysis:</span></a>
<a class="sourceLine" id="cb8-3" data-line-number="3">clade &lt;-<span class="st"> </span><span class="kw"><a href="../reference/clade_phylm.html">clade_phylm</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(sexMaturity) <span class="op">~</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(adultMass), <span class="dt">phy =</span> primates<span class="op">$</span>phy[[<span class="dv">1</span>]],</a>
<a class="sourceLine" id="cb8-4" data-line-number="4">                     <span class="dt">data =</span> primates<span class="op">$</span>data, <span class="dt">clade.col =</span> <span class="st">"family"</span>, <span class="dt">track=</span><span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb8-5" data-line-number="5"><span class="co"># To check summary results and most influential clades:</span></a>
<a class="sourceLine" id="cb8-6" data-line-number="6"><span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(clade)</a></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="co"># Visual diagnostics for clade removal:</span></a>
<a class="sourceLine" id="cb9-2" data-line-number="2"><span class="kw"><a href="../reference/sensi_plot.html">sensi_plot</a></span>(clade, <span class="st">"Cercopithecidae"</span>)</a></code></pre></div>
<pre><code><a href="../reference/sensi_plot.html">sensi_plot(clade, "Cebidae")</a></code></pre>
</div>
<div id="clade_physig-phylogenetic-signal" class="section level5">
<h5 class="hasAnchor">
<a href="#clade_physig-phylogenetic-signal" class="anchor"></a>1.2.2 clade_physig(): Phylogenetic signal</h5>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="co"># Logtransform data</span></a>
<a class="sourceLine" id="cb11-2" data-line-number="2">alien.data<span class="op">$</span>logMass &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(alien.data<span class="op">$</span>adultMass)</a>
<a class="sourceLine" id="cb11-3" data-line-number="3"><span class="co"># Run sensitivity analysis:</span></a>
<a class="sourceLine" id="cb11-4" data-line-number="4">clade &lt;-<span class="st"> </span><span class="kw"><a href="../reference/clade_physig.html">clade_physig</a></span>(<span class="dt">trait.col =</span> <span class="st">"logMass"</span>, <span class="dt">data =</span> alien.data, <span class="dt">n.sim =</span> <span class="dv">100</span>,</a>
<a class="sourceLine" id="cb11-5" data-line-number="5">                      <span class="dt">phy =</span> alien.phy[[<span class="dv">1</span>]], <span class="dt">clade.col =</span> <span class="st">"family"</span>, <span class="dt">method =</span> <span class="st">"K"</span>, <span class="dt">track=</span><span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb11-6" data-line-number="6"><span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(clade)</a>
<a class="sourceLine" id="cb11-7" data-line-number="7"><span class="kw"><a href="../reference/sensi_plot.html">sensi_plot</a></span>(clade, <span class="st">"Bovidae"</span>)</a>
<a class="sourceLine" id="cb11-8" data-line-number="8"><span class="kw"><a href="../reference/sensi_plot.html">sensi_plot</a></span>(clade, <span class="st">"Sciuridae"</span>)</a></code></pre></div>
</div>
<div id="clade_continuous-and-clade_discrete-trait-evolution-continuous-and-discrete-characters" class="section level5">
<h5 class="hasAnchor">
<a href="#clade_continuous-and-clade_discrete-trait-evolution-continuous-and-discrete-characters" class="anchor"></a>1.2.3 clade_continuous() and clade_discrete: Trait Evolution Continuous and Discrete Characters</h5>
<p><strong>Continuous characters</strong></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="co"># Load data:</span></a>
<a class="sourceLine" id="cb12-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="st">"primates"</span>)</a>
<a class="sourceLine" id="cb12-3" data-line-number="3"><span class="co"># Model trait evolution accounting for influential clades</span></a>
<a class="sourceLine" id="cb12-4" data-line-number="4">clade_cont &lt;-<span class="st"> </span><span class="kw"><a href="../reference/clade_continuous.html">clade_continuous</a></span>(<span class="dt">data=</span>primates<span class="op">$</span>data, <span class="dt">phy =</span> primates<span class="op">$</span>phy[[<span class="dv">1</span>]], </a>
<a class="sourceLine" id="cb12-5" data-line-number="5"><span class="dt">model=</span><span class="st">"OU"</span>, <span class="dt">trait.col =</span> <span class="st">"adultMass"</span>, <span class="dt">clade.col=</span><span class="st">"family"</span>, <span class="dt">n.sim=</span><span class="dv">30</span>, <span class="dt">n.species=</span><span class="dv">10</span>, </a>
<a class="sourceLine" id="cb12-6" data-line-number="6"><span class="dt">n.cores =</span> <span class="dv">2</span>, <span class="dt">track=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb12-7" data-line-number="7"></a>
<a class="sourceLine" id="cb12-8" data-line-number="8"><span class="co"># Check summary statistics for the transitions rates, aic-values and (if applicable) optimisation parameter</span></a>
<a class="sourceLine" id="cb12-9" data-line-number="9"><span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(clade_cont)</a>
<a class="sourceLine" id="cb12-10" data-line-number="10"><span class="co"># Visual diagnostics</span></a>
<a class="sourceLine" id="cb12-11" data-line-number="11"><span class="kw"><a href="../reference/sensi_plot.html">sensi_plot</a></span>(clade_cont,<span class="dt">graph=</span><span class="st">"all"</span>)</a>
<a class="sourceLine" id="cb12-12" data-line-number="12"><span class="co"># Plot only one clade and one parameter</span></a>
<a class="sourceLine" id="cb12-13" data-line-number="13"><span class="kw"><a href="../reference/sensi_plot.html">sensi_plot</a></span>(clade_cont,<span class="dt">clade=</span><span class="st">"Cebidae"</span>,<span class="dt">graph =</span> <span class="st">"optpar"</span>)</a></code></pre></div>
<p><strong>Discrete characters</strong></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1"><span class="co"># Load data:</span></a>
<a class="sourceLine" id="cb13-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="st">"primates"</span>)</a>
<a class="sourceLine" id="cb13-3" data-line-number="3"></a>
<a class="sourceLine" id="cb13-4" data-line-number="4"><span class="co"># Create a binary trait factor </span></a>
<a class="sourceLine" id="cb13-5" data-line-number="5">primates<span class="op">$</span>data<span class="op">$</span>adultMass_binary&lt;-<span class="kw"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span>(primates<span class="op">$</span>data<span class="op">$</span>adultMass <span class="op">&gt;</span><span class="st"> </span><span class="dv">7350</span>, <span class="st">"big"</span>, <span class="st">"small"</span>)</a>
<a class="sourceLine" id="cb13-6" data-line-number="6"><span class="co"># Model trait evolution accounting for influential clades</span></a>
<a class="sourceLine" id="cb13-7" data-line-number="7">clade_disc &lt;-<span class="st"> </span><span class="kw"><a href="../reference/clade_discrete.html">clade_discrete</a></span>(<span class="dt">data=</span>primates<span class="op">$</span>data,<span class="dt">phy =</span> primates<span class="op">$</span>phy[[<span class="dv">1</span>]],</a>
<a class="sourceLine" id="cb13-8" data-line-number="8">                             <span class="dt">model=</span><span class="st">"ARD"</span>,<span class="dt">transform=</span><span class="st">"kappa"</span>,</a>
<a class="sourceLine" id="cb13-9" data-line-number="9">                             <span class="dt">trait.col =</span> <span class="st">"adultMass_binary"</span>, <span class="dt">clade.col =</span> <span class="st">"family"</span>,</a>
<a class="sourceLine" id="cb13-10" data-line-number="10">                             <span class="dt">n.sim =</span> <span class="dv">30</span>, <span class="dt">n.species=</span><span class="dv">8</span>,<span class="dt">n.cores =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb13-11" data-line-number="11"><span class="co"># Check summary statistics:</span></a>
<a class="sourceLine" id="cb13-12" data-line-number="12"><span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(clade_disc)</a>
<a class="sourceLine" id="cb13-13" data-line-number="13"><span class="co"># Visual diagnostics</span></a>
<a class="sourceLine" id="cb13-14" data-line-number="14"><span class="kw"><a href="../reference/sensi_plot.html">sensi_plot</a></span>(clade_disc)</a></code></pre></div>
</div>
</div>
<div id="sensitivity-analysis-for-sample-size" class="section level3">
<h3 class="hasAnchor">
<a href="#sensitivity-analysis-for-sample-size" class="anchor"></a>1.3. Sensitivity analysis for sample size</h3>
<p>The <code>samp</code> method performs analyses of sensitivity to species sampling by randomly removing species from the dataset and detecting the effects on parameter estimates.</p>
</div>
<div id="samp_phylm-phylogenetic-linear-regression" class="section level3">
<h3 class="hasAnchor">
<a href="#samp_phylm-phylogenetic-linear-regression" class="anchor"></a>1.3.1 samp_phylm: Phylogenetic Linear regression</h3>
<ul>
<li>Additional arguments:<br><strong>breaks:</strong> A vector containing the percentages of species to remove<br><strong>n.sim:</strong> The number of times species are randomly deleted for each break</li>
</ul>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1"><span class="co"># run analysis:</span></a>
<a class="sourceLine" id="cb14-2" data-line-number="2">samp &lt;-<span class="st"> </span><span class="kw"><a href="../reference/samp_phylm.html">samp_phylm</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(gestaLen) <span class="op">~</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(adultMass), <span class="dt">phy =</span> alien<span class="op">$</span>phy[[<span class="dv">1</span>]], </a>
<a class="sourceLine" id="cb14-3" data-line-number="3">                   <span class="dt">data =</span> alien<span class="op">$</span>data, <span class="dt">n.sim =</span> <span class="dv">50</span>, <span class="dt">track=</span><span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb14-4" data-line-number="4"></a>
<a class="sourceLine" id="cb14-5" data-line-number="5"><span class="co"># You can change the number of repetitions and break intervals:</span></a>
<a class="sourceLine" id="cb14-6" data-line-number="6">samp2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/samp_phylm.html">samp_phylm</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(gestaLen) <span class="op">~</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(adultMass), <span class="dt">phy =</span> alien<span class="op">$</span>phy[[<span class="dv">1</span>]],</a>
<a class="sourceLine" id="cb14-7" data-line-number="7">                    <span class="dt">data =</span> alien<span class="op">$</span>data, <span class="dt">n.sim =</span> <span class="dv">100</span>, <span class="dt">breaks =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.1</span>, <span class="fl">0.2</span>, <span class="fl">0.3</span>, <span class="fl">0.4</span>), <span class="dt">track=</span><span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb14-8" data-line-number="8"><span class="co"># You can change the phylogenetic model:</span></a>
<a class="sourceLine" id="cb14-9" data-line-number="9">samp3 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/samp_phylm.html">samp_phylm</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(gestaLen) <span class="op">~</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(adultMass), <span class="dt">phy =</span> alien<span class="op">$</span>phy[[<span class="dv">1</span>]], </a>
<a class="sourceLine" id="cb14-10" data-line-number="10">                   <span class="dt">data =</span> alien<span class="op">$</span>data, <span class="dt">model =</span> <span class="st">"kappa"</span>, <span class="dt">track=</span><span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb14-11" data-line-number="11"><span class="co"># Check results:</span></a>
<a class="sourceLine" id="cb14-12" data-line-number="12"><span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(samp)</a></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1"><span class="co"># Visual diagnostics</span></a>
<a class="sourceLine" id="cb15-2" data-line-number="2"><span class="kw"><a href="../reference/sensi_plot.html">sensi_plot</a></span>(samp)</a>
<a class="sourceLine" id="cb15-3" data-line-number="3"><span class="kw"><a href="../reference/sensi_plot.html">sensi_plot</a></span>(samp2)</a>
<a class="sourceLine" id="cb15-4" data-line-number="4"><span class="kw"><a href="../reference/sensi_plot.html">sensi_plot</a></span>(samp3)</a>
<a class="sourceLine" id="cb15-5" data-line-number="5"></a>
<a class="sourceLine" id="cb15-6" data-line-number="6"><span class="co"># You can specify which graph and parameter ("slope" or "intercept") to print: </span></a>
<a class="sourceLine" id="cb15-7" data-line-number="7"><span class="kw"><a href="../reference/sensi_plot.html">sensi_plot</a></span>(samp2, <span class="dt">graphs =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb15-8" data-line-number="8"><span class="kw"><a href="../reference/sensi_plot.html">sensi_plot</a></span>(samp2, <span class="dt">param =</span> <span class="st">"intercept"</span>)</a>
<a class="sourceLine" id="cb15-9" data-line-number="9"><span class="kw"><a href="../reference/sensi_plot.html">sensi_plot</a></span>(samp2, <span class="dt">graphs =</span> <span class="dv">2</span>, <span class="dt">param =</span> <span class="st">"estimate"</span>)</a>
<a class="sourceLine" id="cb15-10" data-line-number="10"><span class="kw"><a href="../reference/sensi_plot.html">sensi_plot</a></span>(samp)</a>
<a class="sourceLine" id="cb15-11" data-line-number="11"><span class="kw"><a href="../reference/sensi_plot.html">sensi_plot</a></span>(samp2, <span class="dt">graphs =</span> <span class="dv">1</span>)</a></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1"><span class="kw"><a href="../reference/sensi_plot.html">sensi_plot</a></span>(samp)</a></code></pre></div>
</div>
<div id="samp_physig-phylogenetic-signal-k-or-lambda" class="section level3">
<h3 class="hasAnchor">
<a href="#samp_physig-phylogenetic-signal-k-or-lambda" class="anchor"></a>1.3.2 samp_physig: Phylogenetic signal (k or lambda)</h3>
<ul>
<li>Additional arguments:<br><strong>trait.col:</strong> The name of a column in the provided data frame with trait to be analyzed (e.g. “Body_mass”).<br><strong>method:</strong> Method to compute phylogenetic signal: can be “K” or “lambda”.</li>
</ul>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1"><span class="co"># Logtransform data</span></a>
<a class="sourceLine" id="cb17-2" data-line-number="2">alien.data<span class="op">$</span>logMass &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(alien.data<span class="op">$</span>adultMass) </a>
<a class="sourceLine" id="cb17-3" data-line-number="3"></a>
<a class="sourceLine" id="cb17-4" data-line-number="4"><span class="co"># Run sensitivity analysis:</span></a>
<a class="sourceLine" id="cb17-5" data-line-number="5">samp &lt;-<span class="st"> </span><span class="kw"><a href="../reference/samp_physig.html">samp_physig</a></span>(<span class="dt">trait.col =</span> <span class="st">"logMass"</span>, <span class="dt">data =</span> alien.data, <span class="dt">n.sim =</span> <span class="dv">30</span>, <span class="dt">phy =</span> alien.phy[[<span class="dv">1</span>]], <span class="dt">track=</span><span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb17-6" data-line-number="6"><span class="co"># You can change the method used to estimate signal:</span></a>
<a class="sourceLine" id="cb17-7" data-line-number="7">samp2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/samp_physig.html">samp_physig</a></span>(<span class="dt">trait.col =</span> <span class="st">"logMass"</span>, <span class="dt">data =</span> alien.data, <span class="dt">n.sim =</span> <span class="dv">30</span>,</a>
<a class="sourceLine" id="cb17-8" data-line-number="8">                    <span class="dt">phy =</span> alien.phy[[<span class="dv">1</span>]], <span class="dt">method =</span> <span class="st">"lambda"</span>, <span class="dt">track=</span><span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb17-9" data-line-number="9"><span class="co"># Check results:</span></a>
<a class="sourceLine" id="cb17-10" data-line-number="10"><span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(samp)</a>
<a class="sourceLine" id="cb17-11" data-line-number="11"><span class="co"># Visual diagnostics</span></a>
<a class="sourceLine" id="cb17-12" data-line-number="12"><span class="kw"><a href="../reference/sensi_plot.html">sensi_plot</a></span>(samp)</a></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1"><span class="co"># More visual diagnostics</span></a>
<a class="sourceLine" id="cb18-2" data-line-number="2"><span class="kw"><a href="../reference/sensi_plot.html">sensi_plot</a></span>(samp2)</a>
<a class="sourceLine" id="cb18-3" data-line-number="3"><span class="kw"><a href="../reference/sensi_plot.html">sensi_plot</a></span>(samp, <span class="dt">graphs =</span> <span class="dv">1</span>)</a></code></pre></div>
</div>
<div id="samp_continuous-and-samp_discrete-trait-evolution-continuous-and-discrete-characters" class="section level3">
<h3 class="hasAnchor">
<a href="#samp_continuous-and-samp_discrete-trait-evolution-continuous-and-discrete-characters" class="anchor"></a>1.3.3 samp_continuous() and samp_discrete: Trait Evolution Continuous and Discrete Characters</h3>
<p><strong>Continuous characters</strong></p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1"><span class="co"># Load data:</span></a>
<a class="sourceLine" id="cb19-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="st">"primates"</span>)</a>
<a class="sourceLine" id="cb19-3" data-line-number="3"></a>
<a class="sourceLine" id="cb19-4" data-line-number="4"><span class="co"># Model trait evolution</span></a>
<a class="sourceLine" id="cb19-5" data-line-number="5">adultMass&lt;-primates<span class="op">$</span>data<span class="op">$</span>adultMass</a>
<a class="sourceLine" id="cb19-6" data-line-number="6"><span class="kw"><a href="https://rdrr.io/r/base/names.html">names</a></span>(adultMass)&lt;-<span class="kw"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(primates<span class="op">$</span>data)</a>
<a class="sourceLine" id="cb19-7" data-line-number="7">samp_cont&lt;-<span class="kw"><a href="../reference/samp_continuous.html">samp_continuous</a></span>(<span class="dt">data =</span> adultMass,<span class="dt">phy =</span> primates<span class="op">$</span>phy[[<span class="dv">1</span>]],</a>
<a class="sourceLine" id="cb19-8" data-line-number="8"><span class="dt">model =</span> <span class="st">"OU"</span>,<span class="dt">n.sim=</span><span class="dv">25</span>,<span class="dt">breaks=</span><span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(.<span class="dv">05</span>,.<span class="dv">2</span>,.<span class="dv">05</span>),<span class="dt">n.cores =</span> <span class="dv">2</span>, <span class="dt">track =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb19-9" data-line-number="9"><span class="co"># Print summary statistics for the transitions rates, aic-values and (if applicable) </span></a>
<a class="sourceLine" id="cb19-10" data-line-number="10"><span class="co"># optimisation parameter</span></a>
<a class="sourceLine" id="cb19-11" data-line-number="11"><span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(samp_cont)</a>
<a class="sourceLine" id="cb19-12" data-line-number="12"><span class="co"># Visual diagnostics</span></a>
<a class="sourceLine" id="cb19-13" data-line-number="13"><span class="kw"><a href="../reference/sensi_plot.html">sensi_plot</a></span>(samp_cont)</a></code></pre></div>
<p><strong>Discrete characters</strong></p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1"><span class="co"># Load data:</span></a>
<a class="sourceLine" id="cb20-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="st">"primates"</span>)</a>
<a class="sourceLine" id="cb20-3" data-line-number="3"><span class="co"># Create a binary trait factor </span></a>
<a class="sourceLine" id="cb20-4" data-line-number="4">adultMass_binary&lt;-<span class="kw"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span>(primates<span class="op">$</span>data<span class="op">$</span>adultMass <span class="op">&gt;</span><span class="st"> </span><span class="dv">7350</span>, <span class="st">"big"</span>, <span class="st">"small"</span>)</a>
<a class="sourceLine" id="cb20-5" data-line-number="5">adultMass_binary&lt;-<span class="kw"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(adultMass_binary))</a>
<a class="sourceLine" id="cb20-6" data-line-number="6"><span class="kw"><a href="https://rdrr.io/r/base/names.html">names</a></span>(adultMass_binary)&lt;-<span class="kw"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(primates<span class="op">$</span>data)</a>
<a class="sourceLine" id="cb20-7" data-line-number="7"><span class="co"># Model trait evolution</span></a>
<a class="sourceLine" id="cb20-8" data-line-number="8">samp_binary &lt;-<span class="st"> </span><span class="kw"><a href="../reference/samp_discrete.html">samp_discrete</a></span>(<span class="dt">data =</span> adultMass_binary,<span class="dt">phy =</span> primates<span class="op">$</span>phy[[<span class="dv">1</span>]], <span class="dt">n.sim=</span><span class="dv">25</span>,</a>
<a class="sourceLine" id="cb20-9" data-line-number="9">    <span class="dt">breaks =</span> <span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(.<span class="dv">1</span>,.<span class="dv">3</span>,.<span class="dv">1</span>),<span class="dt">model =</span> <span class="st">"ARD"</span>, <span class="dt">transform =</span> <span class="st">"lambda"</span>, <span class="dt">n.cores =</span> <span class="dv">2</span>,</a>
<a class="sourceLine" id="cb20-10" data-line-number="10">    <span class="dt">track =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb20-11" data-line-number="11"><span class="co"># Print summary statistics for the transitions rates, aic-values and (if applicable) </span></a>
<a class="sourceLine" id="cb20-12" data-line-number="12"><span class="co"># optimisation parameter</span></a>
<a class="sourceLine" id="cb20-13" data-line-number="13"><span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(samp_binary)</a>
<a class="sourceLine" id="cb20-14" data-line-number="14"><span class="co"># Visual diagnostics</span></a>
<a class="sourceLine" id="cb20-15" data-line-number="15"><span class="kw"><a href="../reference/sensi_plot.html">sensi_plot</a></span>(samp_binary)</a></code></pre></div>
</div>
</div>
<div id="phylogenetic-uncertainty" class="section level2">
<h2 class="hasAnchor">
<a href="#phylogenetic-uncertainty" class="anchor"></a>2. Phylogenetic uncertainty</h2>
<p>The <code>tree</code> method performs sensitivity analysis to estimate the influence of phylogenetic uncertainty on parameter estimates.</p>
<p>Additional arguments:<br><strong>n.tree:</strong> Number of times to repeat the analysis with n different trees picked randomly in the multiPhylo file.</p>
<div id="tree_phylm-tree-method-for-phylogenetic-linear-regression" class="section level3">
<h3 class="hasAnchor">
<a href="#tree_phylm-tree-method-for-phylogenetic-linear-regression" class="anchor"></a>2.1 tree_phylm: <code>tree</code> method for phylogenetic linear regression</h3>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" data-line-number="1"><span class="co"># Load data</span></a>
<a class="sourceLine" id="cb21-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(alien)</a>
<a class="sourceLine" id="cb21-3" data-line-number="3"><span class="co"># This analysis needs a multiphylo file:</span></a>
<a class="sourceLine" id="cb21-4" data-line-number="4"><span class="kw"><a href="https://rdrr.io/r/base/class.html">class</a></span>(alien<span class="op">$</span>phy)</a>
<a class="sourceLine" id="cb21-5" data-line-number="5">alien<span class="op">$</span>phy</a>
<a class="sourceLine" id="cb21-6" data-line-number="6"><span class="co"># run PGLS accounting for phylogenetic uncertainty:</span></a>
<a class="sourceLine" id="cb21-7" data-line-number="7">tree &lt;-<span class="st"> </span><span class="kw"><a href="../reference/tree_phylm.html">tree_phylm</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(gestaLen) <span class="op">~</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(adultMass), <span class="dt">phy =</span> alien<span class="op">$</span>phy, </a>
<a class="sourceLine" id="cb21-8" data-line-number="8">                   <span class="dt">data =</span> alien<span class="op">$</span>data, <span class="dt">n.tree =</span> <span class="dv">30</span>, <span class="dt">track=</span><span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb21-9" data-line-number="9"><span class="co"># To check summary results:</span></a>
<a class="sourceLine" id="cb21-10" data-line-number="10"><span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(tree)</a>
<a class="sourceLine" id="cb21-11" data-line-number="11"><span class="co"># Visual diagnostics</span></a>
<a class="sourceLine" id="cb21-12" data-line-number="12"><span class="kw"><a href="../reference/sensi_plot.html">sensi_plot</a></span>(tree)</a></code></pre></div>
</div>
<div id="tree_physig-tree-method-for-phylogenetic-signal" class="section level3">
<h3 class="hasAnchor">
<a href="#tree_physig-tree-method-for-phylogenetic-signal" class="anchor"></a>2.2 tree_physig(): <code>tree</code> method for phylogenetic signal</h3>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" data-line-number="1"><span class="co"># Load data:</span></a>
<a class="sourceLine" id="cb22-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(alien)</a>
<a class="sourceLine" id="cb22-3" data-line-number="3"><span class="co"># Logtransform data</span></a>
<a class="sourceLine" id="cb22-4" data-line-number="4">alien.data<span class="op">$</span>logMass &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(alien.data<span class="op">$</span>adultMass) </a>
<a class="sourceLine" id="cb22-5" data-line-number="5"><span class="co"># Run sensitivity analysis:</span></a>
<a class="sourceLine" id="cb22-6" data-line-number="6">tree &lt;-<span class="st"> </span><span class="kw"><a href="../reference/tree_physig.html">tree_physig</a></span>(<span class="dt">trait.col =</span> <span class="st">"logMass"</span>, <span class="dt">data =</span> alien.data, <span class="dt">phy =</span> alien.phy, <span class="dt">track=</span><span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb22-7" data-line-number="7"><span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(tree)</a></code></pre></div>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" data-line-number="1"><span class="kw"><a href="../reference/sensi_plot.html">sensi_plot</a></span>(tree, <span class="dt">graphs =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb23-2" data-line-number="2"><span class="kw"><a href="../reference/sensi_plot.html">sensi_plot</a></span>(tree, <span class="dt">graphs =</span> <span class="dv">2</span>)</a></code></pre></div>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" data-line-number="1"><span class="kw"><a href="../reference/sensi_plot.html">sensi_plot</a></span>(tree) </a></code></pre></div>
</div>
<div id="tree_continuous-and-tree_discrete-tree-method-for-trait-evolution-of-continuous-and-discrete-characters" class="section level3">
<h3 class="hasAnchor">
<a href="#tree_continuous-and-tree_discrete-tree-method-for-trait-evolution-of-continuous-and-discrete-characters" class="anchor"></a>2.3 tree_continuous() and tree_discrete: <code>tree</code> method for trait evolution of continuous and discrete characters</h3>
<p><strong>Continuous characters</strong></p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" data-line-number="1"><span class="co"># Load data:</span></a>
<a class="sourceLine" id="cb25-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="st">"primates"</span>)</a>
<a class="sourceLine" id="cb25-3" data-line-number="3"><span class="co"># Model trait evolution accounting for phylogenetic uncertainty</span></a>
<a class="sourceLine" id="cb25-4" data-line-number="4">adultMass&lt;-primates<span class="op">$</span>data<span class="op">$</span>adultMass</a>
<a class="sourceLine" id="cb25-5" data-line-number="5"><span class="kw"><a href="https://rdrr.io/r/base/names.html">names</a></span>(adultMass)&lt;-<span class="kw"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(primates<span class="op">$</span>data)</a>
<a class="sourceLine" id="cb25-6" data-line-number="6">tree_cont&lt;-<span class="kw"><a href="../reference/tree_continuous.html">tree_continuous</a></span>(<span class="dt">data =</span> adultMass,<span class="dt">phy =</span> primates<span class="op">$</span>phy,</a>
<a class="sourceLine" id="cb25-7" data-line-number="7"><span class="dt">model =</span> <span class="st">"OU"</span>,<span class="dt">n.tree=</span><span class="dv">30</span>,<span class="dt">n.cores =</span> <span class="dv">2</span>,<span class="dt">track =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb25-8" data-line-number="8"><span class="co"># Print summary statistics for the transitions rates, aic-values and (if applicable) </span></a>
<a class="sourceLine" id="cb25-9" data-line-number="9"><span class="co"># optimisation parameter</span></a>
<a class="sourceLine" id="cb25-10" data-line-number="10"><span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(tree_cont)</a></code></pre></div>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" data-line-number="1"><span class="co"># Plot only some parameters</span></a>
<a class="sourceLine" id="cb26-2" data-line-number="2"><span class="kw"><a href="../reference/sensi_plot.html">sensi_plot</a></span>(tree_cont,<span class="dt">graphs=</span><span class="st">"sigsq"</span>)</a>
<a class="sourceLine" id="cb26-3" data-line-number="3"><span class="kw"><a href="../reference/sensi_plot.html">sensi_plot</a></span>(tree_cont,<span class="dt">graphs=</span><span class="st">"optpar"</span>)</a></code></pre></div>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" data-line-number="1"><span class="co">## Visual diagnostics</span></a>
<a class="sourceLine" id="cb27-2" data-line-number="2"><span class="kw"><a href="../reference/sensi_plot.html">sensi_plot</a></span>(tree_cont)</a></code></pre></div>
<p><strong>Discrete characters</strong></p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" data-line-number="1"><span class="co"># Load data:</span></a>
<a class="sourceLine" id="cb28-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="st">"primates"</span>)</a>
<a class="sourceLine" id="cb28-3" data-line-number="3"><span class="co"># Create a binary trait factor </span></a>
<a class="sourceLine" id="cb28-4" data-line-number="4">adultMass_binary&lt;-<span class="kw"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span>(primates<span class="op">$</span>data<span class="op">$</span>adultMass <span class="op">&gt;</span><span class="st"> </span><span class="dv">7350</span>, <span class="st">"big"</span>, <span class="st">"small"</span>)</a>
<a class="sourceLine" id="cb28-5" data-line-number="5">adultMass_binary&lt;-<span class="kw"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(adultMass_binary))</a>
<a class="sourceLine" id="cb28-6" data-line-number="6"><span class="kw"><a href="https://rdrr.io/r/base/names.html">names</a></span>(adultMass_binary)&lt;-<span class="kw"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(primates<span class="op">$</span>data)</a>
<a class="sourceLine" id="cb28-7" data-line-number="7"><span class="co"># Model trait evolution accounting for phylogenetic uncertainty</span></a>
<a class="sourceLine" id="cb28-8" data-line-number="8">tree_binary&lt;-<span class="kw"><a href="../reference/tree_discrete.html">tree_discrete</a></span>(<span class="dt">data =</span> adultMass_binary,<span class="dt">phy =</span> primates<span class="op">$</span>phy,</a>
<a class="sourceLine" id="cb28-9" data-line-number="9"><span class="dt">model =</span> <span class="st">"ARD"</span>,<span class="dt">transform =</span> <span class="st">"none"</span>,<span class="dt">n.tree =</span> <span class="dv">30</span>,<span class="dt">n.cores =</span> <span class="dv">2</span>,<span class="dt">track =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb28-10" data-line-number="10"><span class="co"># Print summary statistics for the transitions rates, aic-values and (if applicable) </span></a>
<a class="sourceLine" id="cb28-11" data-line-number="11"><span class="co"># optimisation parameter</span></a>
<a class="sourceLine" id="cb28-12" data-line-number="12"><span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(tree_binary)</a></code></pre></div>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" data-line-number="1"><span class="co">## Visual diagnostics</span></a>
<a class="sourceLine" id="cb29-2" data-line-number="2"><span class="kw"><a href="../reference/sensi_plot.html">sensi_plot</a></span>(tree_binary,<span class="dt">graphs=</span><span class="st">"q12"</span>)</a>
<a class="sourceLine" id="cb29-3" data-line-number="3"><span class="kw"><a href="../reference/sensi_plot.html">sensi_plot</a></span>(tree_binary,<span class="dt">graphs=</span><span class="st">"q21"</span>)</a></code></pre></div>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" data-line-number="1"><span class="kw"><a href="../reference/sensi_plot.html">sensi_plot</a></span>(tree_binary)</a></code></pre></div>
</div>
</div>
<div id="data-uncertainty" class="section level2">
<h2 class="hasAnchor">
<a href="#data-uncertainty" class="anchor"></a>3. Data uncertainty</h2>
<p>The <code>intra</code> method performs Sensitivity analysis for intraspecific variation and measurement error</p>
<div id="intra_phylm-intra-method-for-phylogenetic-linear-regression" class="section level3">
<h3 class="hasAnchor">
<a href="#intra_phylm-intra-method-for-phylogenetic-linear-regression" class="anchor"></a>3.1 intra_phylm(): <code>intra</code> method for phylogenetic linear regression</h3>
<p>Additional arguments:<br><strong>Vy:</strong> Name of the column containing the standard deviation or the standard error of the response variable. When information is not available for one taxon, the value can be 0 or NA.<br><strong>Vx:</strong> Name of the column containing the standard deviation or the standard error of the predictor variable. When information is not available for one taxon, the value can be 0 or NA<br><strong>x.transf:</strong> Transformation for the response variable (e.g. log or sqrt). Please use this argument instead of transforming data in the formula directly.<br><strong>y.transf:</strong> Transformation for the predictor variable (e.g. log or sqrt). Please use this argument instead of transforming data in the formula directly.<br><strong>distrib:</strong> A character string indicating which distribution to use to generate a random value for the response and/or predictor variables. Default is normal distribution: “normal” (function rnorm). Uniform distribution: “uniform” (runif) Warning: we recommend to use normal distribution with Vx or Vy = standard deviation of the mean.<br><strong>n.intra:</strong> Number of times to repeat the analysis with n different trees picked randomly in the multiPhylo file. If NULL, times = 2</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" data-line-number="1"><span class="co"># run PGLS accounting for intraspecific variation:</span></a>
<a class="sourceLine" id="cb31-2" data-line-number="2">intra &lt;-<span class="st"> </span><span class="kw"><a href="../reference/intra_phylm.html">intra_phylm</a></span>(gestaLen <span class="op">~</span><span class="st"> </span>adultMass, <span class="dt">phy =</span> alien<span class="op">$</span>phy[[<span class="dv">1</span>]], </a>
<a class="sourceLine" id="cb31-3" data-line-number="3">                     <span class="dt">data =</span> alien<span class="op">$</span>data, <span class="dt">Vy =</span> <span class="st">"SD_gesta"</span>, <span class="dt">Vx =</span> <span class="st">"SD_mass"</span>,</a>
<a class="sourceLine" id="cb31-4" data-line-number="4">                     <span class="dt">n.intra =</span> <span class="dv">100</span>, <span class="dt">x.transf =</span> log, <span class="dt">y.transf =</span> log, <span class="dt">track=</span><span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb31-5" data-line-number="5"><span class="co"># To check summary results:</span></a>
<a class="sourceLine" id="cb31-6" data-line-number="6"><span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(intra)</a>
<a class="sourceLine" id="cb31-7" data-line-number="7"><span class="co"># Visual diagnostics</span></a>
<a class="sourceLine" id="cb31-8" data-line-number="8"><span class="kw"><a href="../reference/sensi_plot.html">sensi_plot</a></span>(intra)</a></code></pre></div>
</div>
<div id="intra_physig-intra-method-for-phylogenetic-signal" class="section level3">
<h3 class="hasAnchor">
<a href="#intra_physig-intra-method-for-phylogenetic-signal" class="anchor"></a>3.2 intra_physig(): <code>intra</code> method for phylogenetic signal</h3>
<p>Additional arguments:<br><strong>V</strong>: Name of the column containing the standard deviation or the standard error of the trait variable. When information is not available for one taxon, the value can be 0 or NA.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(alien)</a>
<a class="sourceLine" id="cb32-2" data-line-number="2"><span class="co"># Run sensitivity analysis:</span></a>
<a class="sourceLine" id="cb32-3" data-line-number="3">intra &lt;-<span class="st"> </span><span class="kw"><a href="../reference/intra_physig.html">intra_physig</a></span>(<span class="dt">trait.col =</span> <span class="st">"gestaLen"</span>, <span class="dt">V =</span> <span class="st">"SD_gesta"</span> , <span class="dt">data =</span> alien.data, </a>
<a class="sourceLine" id="cb32-4" data-line-number="4">                      <span class="dt">phy =</span> alien.phy[[<span class="dv">1</span>]], <span class="dt">n.intra =</span> <span class="dv">100</span>, <span class="dt">track=</span><span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb32-5" data-line-number="5"><span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(intra)</a></code></pre></div>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" data-line-number="1"><span class="kw"><a href="../reference/sensi_plot.html">sensi_plot</a></span>(intra, <span class="dt">graphs =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb33-2" data-line-number="2"><span class="kw"><a href="../reference/sensi_plot.html">sensi_plot</a></span>(intra, <span class="dt">graphs =</span> <span class="dv">2</span>)</a></code></pre></div>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" data-line-number="1"><span class="kw"><a href="../reference/sensi_plot.html">sensi_plot</a></span>(intra)</a></code></pre></div>
</div>
</div>
<div id="interacting-uncertainties" class="section level2">
<h2 class="hasAnchor">
<a href="#interacting-uncertainties" class="anchor"></a>4. Interacting uncertainties</h2>
<p>The ‘sensiPhy’ package can perform sensitivity analysis by interacting multiple types of uncertainty (described above).</p>
<p>‘sensiPhy’ implements functions to study interactions of both phylogenetic uncertainty (tree-functions) and data uncertainty (intra-functions) with sampling uncertainty (<code>clade</code>, <code>influ</code>, and <code>samp</code>), as well as interactions between data and phylogenetic uncertainty (<code>tree_intra</code>).</p>
<p>Both <code>intra</code> and <code>tree</code> methods can be used together with all other uncertainties to evaluate the interaction between two types of uncertainty at the same time.</p>
<div id="examples" class="section level3">
<h3 class="hasAnchor">
<a href="#examples" class="anchor"></a>Examples:</h3>
<div id="tree_influ_phylm-tree_influ-method-for-phylogenetic-linear-regression" class="section level4">
<h4 class="hasAnchor">
<a href="#tree_influ_phylm-tree_influ-method-for-phylogenetic-linear-regression" class="anchor"></a>4.1 tree_influ_phylm(): <code>tree_influ</code> method for phylogenetic linear regression</h4>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(alien)</a>
<a class="sourceLine" id="cb35-2" data-line-number="2"><span class="co"># run analysis:</span></a>
<a class="sourceLine" id="cb35-3" data-line-number="3">tree_influ &lt;-<span class="st"> </span><span class="kw"><a href="../reference/tree_influ_phylm.html">tree_influ_phylm</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(gestaLen) <span class="op">~</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(adultMass), <span class="dt">phy =</span> alien<span class="op">$</span>phy, </a>
<a class="sourceLine" id="cb35-4" data-line-number="4">                               <span class="dt">data =</span> alien<span class="op">$</span>data, <span class="dt">n.tree =</span> <span class="dv">5</span>, <span class="dt">track=</span><span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb35-5" data-line-number="5"><span class="co"># To check summary results:</span></a>
<a class="sourceLine" id="cb35-6" data-line-number="6"><span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(tree_influ)</a></code></pre></div>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" data-line-number="1"><span class="co"># Visual diagnostics</span></a>
<a class="sourceLine" id="cb36-2" data-line-number="2"><span class="kw"><a href="../reference/sensi_plot.html">sensi_plot</a></span>(tree_influ, <span class="dt">graphs =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb36-3" data-line-number="3"><span class="kw"><a href="../reference/sensi_plot.html">sensi_plot</a></span>(tree_influ, <span class="dt">graphs =</span> <span class="dv">2</span>)</a></code></pre></div>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" data-line-number="1"><span class="kw"><a href="../reference/sensi_plot.html">sensi_plot</a></span>(tree_influ)</a></code></pre></div>
</div>
<div id="tree_clade_phylm-tree_clade-method-for-phylogenetic-linear-regression" class="section level4">
<h4 class="hasAnchor">
<a href="#tree_clade_phylm-tree_clade-method-for-phylogenetic-linear-regression" class="anchor"></a>4.2 tree_clade_phylm(): <code>tree_clade</code> method for phylogenetic linear regression</h4>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(primates)</a>
<a class="sourceLine" id="cb38-2" data-line-number="2"><span class="co"># run analysis:</span></a>
<a class="sourceLine" id="cb38-3" data-line-number="3">clade_tree &lt;-<span class="st"> </span><span class="kw"><a href="../reference/tree_clade_phylm.html">tree_clade_phylm</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(sexMaturity) <span class="op">~</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(adultMass), </a>
<a class="sourceLine" id="cb38-4" data-line-number="4">                               <span class="dt">phy =</span> primates<span class="op">$</span>phy, <span class="dt">data =</span> primates<span class="op">$</span>data,</a>
<a class="sourceLine" id="cb38-5" data-line-number="5">                               <span class="dt">clade.col =</span> <span class="st">"family"</span>,</a>
<a class="sourceLine" id="cb38-6" data-line-number="6">                               <span class="dt">n.sim =</span> <span class="dv">50</span>, <span class="dt">n.tree =</span> <span class="dv">5</span>, <span class="dt">track=</span>F)</a>
<a class="sourceLine" id="cb38-7" data-line-number="7"><span class="co"># To check summary results and most influential clades:</span></a>
<a class="sourceLine" id="cb38-8" data-line-number="8"><span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(clade_tree)</a></code></pre></div>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" data-line-number="1"><span class="co"># Visual diagnostics for clade removal:</span></a>
<a class="sourceLine" id="cb39-2" data-line-number="2"><span class="kw"><a href="../reference/sensi_plot.html">sensi_plot</a></span>(clade_tree)</a></code></pre></div>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" data-line-number="1"><span class="co"># Specify which clade removal to plot:</span></a>
<a class="sourceLine" id="cb40-2" data-line-number="2"><span class="kw"><a href="../reference/sensi_plot.html">sensi_plot</a></span>(clade_tree, <span class="st">"Cercopithecidae"</span>)</a>
<a class="sourceLine" id="cb40-3" data-line-number="3"><span class="kw"><a href="../reference/sensi_plot.html">sensi_plot</a></span>(clade_tree, <span class="dt">clade =</span> <span class="st">"Cebidae"</span>)</a></code></pre></div>
</div>
<div id="tree_samp_phylm-tree_samp-method-for-phylogenetic-linear-regression" class="section level4">
<h4 class="hasAnchor">
<a href="#tree_samp_phylm-tree_samp-method-for-phylogenetic-linear-regression" class="anchor"></a>4.3 tree_samp_phylm(): <code>tree_samp</code> method for phylogenetic linear regression</h4>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" data-line-number="1"><span class="co"># Load data:</span></a>
<a class="sourceLine" id="cb41-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(alien)</a>
<a class="sourceLine" id="cb41-3" data-line-number="3"><span class="co"># Run analysis:</span></a>
<a class="sourceLine" id="cb41-4" data-line-number="4">samp &lt;-<span class="st"> </span><span class="kw"><a href="../reference/tree_samp_phylm.html">tree_samp_phylm</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(gestaLen) <span class="op">~</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(adultMass), <span class="dt">phy =</span> alien<span class="op">$</span>phy,</a>
<a class="sourceLine" id="cb41-5" data-line-number="5">                        <span class="dt">data =</span> alien<span class="op">$</span>data, <span class="dt">n.tree =</span> <span class="dv">5</span>, <span class="dt">n.sim=</span><span class="dv">30</span>, <span class="dt">track=</span><span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb41-6" data-line-number="6"><span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(samp)</a>
<a class="sourceLine" id="cb41-7" data-line-number="7"><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(samp<span class="op">$</span>sensi.estimates)</a>
<a class="sourceLine" id="cb41-8" data-line-number="8"><span class="co"># Visual diagnostics</span></a>
<a class="sourceLine" id="cb41-9" data-line-number="9"><span class="kw"><a href="../reference/sensi_plot.html">sensi_plot</a></span>(samp)</a></code></pre></div>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" data-line-number="1"><span class="kw"><a href="../reference/sensi_plot.html">sensi_plot</a></span>(samp, <span class="dt">graphs =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb42-2" data-line-number="2"><span class="kw"><a href="../reference/sensi_plot.html">sensi_plot</a></span>(samp, <span class="dt">graphs =</span> <span class="dv">2</span>)</a></code></pre></div>
</div>
<div id="tree_intra_phylm-tree_intra-method-for-phylogenetic-linear-regression" class="section level4">
<h4 class="hasAnchor">
<a href="#tree_intra_phylm-tree_intra-method-for-phylogenetic-linear-regression" class="anchor"></a>4.4 tree_intra_phylm(): <code>tree_intra</code> method for phylogenetic linear regression</h4>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb43-1" data-line-number="1"><span class="co"># Load data:</span></a>
<a class="sourceLine" id="cb43-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(alien)</a>
<a class="sourceLine" id="cb43-3" data-line-number="3"><span class="co"># run PGLS accounting for intraspecific and phylogenetic variation:</span></a>
<a class="sourceLine" id="cb43-4" data-line-number="4">intra.tree &lt;-<span class="st"> </span><span class="kw"><a href="../reference/tree_intra_phylm.html">tree_intra_phylm</a></span>(gestaLen <span class="op">~</span><span class="st"> </span>adultMass, <span class="dt">data =</span> alien<span class="op">$</span>data, <span class="dt">phy =</span> alien<span class="op">$</span>phy,</a>
<a class="sourceLine" id="cb43-5" data-line-number="5">                               <span class="dt">Vy =</span> <span class="st">"SD_gesta"</span>, <span class="dt">n.intra =</span> <span class="dv">10</span>, <span class="dt">n.tree =</span> <span class="dv">30</span>, </a>
<a class="sourceLine" id="cb43-6" data-line-number="6">                               <span class="dt">y.transf =</span> log, <span class="dt">x.transf =</span> log, <span class="dt">track=</span><span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb43-7" data-line-number="7"><span class="co"># To check summary results:</span></a>
<a class="sourceLine" id="cb43-8" data-line-number="8"><span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(intra.tree)</a>
<a class="sourceLine" id="cb43-9" data-line-number="9"><span class="co"># Visual diagnostics</span></a>
<a class="sourceLine" id="cb43-10" data-line-number="10"><span class="kw"><a href="../reference/sensi_plot.html">sensi_plot</a></span>(intra.tree, <span class="dt">uncer.type =</span> <span class="st">"all"</span>) <span class="co">#or uncer.type = "tree", uncer.type = "intra"</span></a></code></pre></div>
</div>
</div>
</div>
<div id="additional-functions" class="section level2">
<h2 class="hasAnchor">
<a href="#additional-functions" class="anchor"></a>5. Additional functions</h2>
<div id="combine-data-and-phylogeny" class="section level3">
<h3 class="hasAnchor">
<a href="#combine-data-and-phylogeny" class="anchor"></a>5.1 Combine data and phylogeny</h3>
<p>The function <code>match_dataphy</code> combines phylogeny and data to ensure that tips in phylogeny match data and that observations with missing values are removed.</p>
<blockquote>
<p>This function uses all variables provided in the ‘formula’ to match data and phylogeny. To avoid cropping the full dataset, ‘match_dataphy’ searches for NA values only on variables provided by formula. Missing values on other variables, not included in ‘formula’, will not be removed from data.</p>
</blockquote>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb44-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(sensiPhy)</a>
<a class="sourceLine" id="cb44-2" data-line-number="2"><span class="co"># Load data:</span></a>
<a class="sourceLine" id="cb44-3" data-line-number="3"><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(alien)</a>
<a class="sourceLine" id="cb44-4" data-line-number="4"><span class="co"># Match data and phy based on model formula:</span></a>
<a class="sourceLine" id="cb44-5" data-line-number="5">comp.data &lt;-<span class="st"> </span><span class="kw"><a href="../reference/match_dataphy.html">match_dataphy</a></span>(gestaLen <span class="op">~</span><span class="st"> </span>homeRange, <span class="dt">data =</span> alien<span class="op">$</span>data, alien<span class="op">$</span>phy[[<span class="dv">1</span>]], <span class="dt">track=</span><span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb44-6" data-line-number="6"><span class="co"># With a `multiphylo` tree:</span></a>
<a class="sourceLine" id="cb44-7" data-line-number="7">comp.data2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/match_dataphy.html">match_dataphy</a></span>(homeRange <span class="op">~</span><span class="st"> </span>homeRange, <span class="dt">data =</span> alien<span class="op">$</span>data, alien<span class="op">$</span>phy, <span class="dt">track=</span><span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb44-8" data-line-number="8"><span class="co"># Check combined data:</span></a>
<a class="sourceLine" id="cb44-9" data-line-number="9">knitr<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span>(<span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(comp.data<span class="op">$</span>data))</a></code></pre></div>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb45-1" data-line-number="1"><span class="co"># Check phy:</span></a>
<a class="sourceLine" id="cb45-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(comp.data<span class="op">$</span>phy)</a></code></pre></div>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb46-1" data-line-number="1"><span class="co"># See species dropped from phy or data:</span></a>
<a class="sourceLine" id="cb46-2" data-line-number="2">comp.data<span class="op">$</span>dropped</a></code></pre></div>
</div>
<div id="phylogenetic-signal-for-missing-data" class="section level3">
<h3 class="hasAnchor">
<a href="#phylogenetic-signal-for-missing-data" class="anchor"></a>5.2 Phylogenetic signal for missing data</h3>
<div id="background" class="section level4">
<h4 class="hasAnchor">
<a href="#background" class="anchor"></a>Background</h4>
<p>The supplementary function <code>miss.phylo.d</code> tests if there is a phylogenetic signal in missing data, using the D framework developed in Fritz &amp; Purvis (2010). A phylogenetic signal in missing data can bias comparative analyses, because it means that absence of data points is not independent of the phylogeny. This function can help alert users to this problem, suggesting that more balanced data collection would be required.</p>
<p>The function calculates D statistic for missing data. Missingness is recoded into a binary variable (1 = missing, 0 = non missing).</p>
</div>
<div id="example" class="section level4">
<h4 class="hasAnchor">
<a href="#example" class="anchor"></a>Example:</h4>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb47-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(sensiPhy)</a>
<a class="sourceLine" id="cb47-2" data-line-number="2"><span class="co"># Load caper:</span></a>
<a class="sourceLine" id="cb47-3" data-line-number="3"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(caper)</a>
<a class="sourceLine" id="cb47-4" data-line-number="4"><span class="co"># Load data</span></a>
<a class="sourceLine" id="cb47-5" data-line-number="5"><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(alien)</a>
<a class="sourceLine" id="cb47-6" data-line-number="6">knitr<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span>(<span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(alien.data))</a></code></pre></div>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb48-1" data-line-number="1">data &lt;-<span class="st"> </span>alien.data</a>
<a class="sourceLine" id="cb48-2" data-line-number="2">phy =<span class="st"> </span>alien.phy[[<span class="dv">1</span>]]</a>
<a class="sourceLine" id="cb48-3" data-line-number="3"></a>
<a class="sourceLine" id="cb48-4" data-line-number="4"><span class="co"># Test phylogenetic signal for missing data:</span></a>
<a class="sourceLine" id="cb48-5" data-line-number="5">homeNAsig &lt;-<span class="st"> </span><span class="kw"><a href="../reference/miss.phylo.d.html">miss.phylo.d</a></span>(data, phy, <span class="dt">binvar =</span> homeRange)</a>
<a class="sourceLine" id="cb48-6" data-line-number="6"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(homeNAsig)</a>
<a class="sourceLine" id="cb48-7" data-line-number="7"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(homeNAsig)</a></code></pre></div>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb49-1" data-line-number="1">massNAsig &lt;-<span class="st"> </span><span class="kw"><a href="../reference/miss.phylo.d.html">miss.phylo.d</a></span>(data, phy, <span class="dt">binvar =</span> adultMass)</a>
<a class="sourceLine" id="cb49-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(massNAsig)</a>
<a class="sourceLine" id="cb49-3" data-line-number="3"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(massNAsig)</a></code></pre></div>
</div>
</div>
<div id="diversification-and-speciation-rates" class="section level3">
<h3 class="hasAnchor">
<a href="#diversification-and-speciation-rates" class="anchor"></a>5.3 Diversification and speciation rates</h3>
<div id="background-1" class="section level4">
<h4 class="hasAnchor">
<a href="#background-1" class="anchor"></a>Background</h4>
<p>The funcion <code>tree_bd</code>estimates diversification and speciation rates evaluating uncertainty in tree topology. It estimates net diversification rate using <code><a href="https://rdrr.io/pkg/geiger/man/bd.ms.html">geiger::bd.ms</a></code> Magallon and Sanderson (2000) method or speciation rate using <code><a href="https://rdrr.io/pkg/geiger/man/bd.ms.html">geiger::bd.km</a></code> Kendall-Moran method for <code>n</code> trees, randomly picked from a <code>multiPhylo</code> file.</p>
</div>
<div id="examples-1" class="section level4">
<h4 class="hasAnchor">
<a href="#examples-1" class="anchor"></a>Examples:</h4>
<p><em>To estimate diversification rate with Magallon and Sanderson method</em></p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb50-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(sensiPhy)</a>
<a class="sourceLine" id="cb50-2" data-line-number="2"><span class="co"># Load data:</span></a>
<a class="sourceLine" id="cb50-3" data-line-number="3"><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="st">"primates"</span>)</a>
<a class="sourceLine" id="cb50-4" data-line-number="4"><span class="co"># Run analysis</span></a>
<a class="sourceLine" id="cb50-5" data-line-number="5">fit.ms &lt;-<span class="st"> </span><span class="kw"><a href="../reference/tree_bd.html">tree_bd</a></span>(<span class="dt">phy =</span> primates.phy, <span class="dt">n.tree =</span> <span class="dv">30</span>, <span class="dt">method =</span> <span class="st">"ms"</span>)</a>
<a class="sourceLine" id="cb50-6" data-line-number="6"><span class="co"># Check results</span></a>
<a class="sourceLine" id="cb50-7" data-line-number="7"><span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(fit.ms)</a>
<a class="sourceLine" id="cb50-8" data-line-number="8"><span class="co"># Plot data</span></a>
<a class="sourceLine" id="cb50-9" data-line-number="9"><span class="kw"><a href="../reference/sensi_plot.html">sensi_plot</a></span>(fit.ms)</a></code></pre></div>
<p><em>To estimate speciation rate Kendall-Moran method</em></p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb51-1" data-line-number="1"><span class="co"># Load data:</span></a>
<a class="sourceLine" id="cb51-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="st">"primates"</span>)</a>
<a class="sourceLine" id="cb51-3" data-line-number="3"><span class="co"># Run analysis</span></a>
<a class="sourceLine" id="cb51-4" data-line-number="4">fit.km &lt;-<span class="st"> </span><span class="kw"><a href="../reference/tree_bd.html">tree_bd</a></span>(<span class="dt">phy =</span> primates.phy, <span class="dt">n.tree =</span> <span class="dv">30</span>, <span class="dt">method =</span> <span class="st">"km"</span>)</a>
<a class="sourceLine" id="cb51-5" data-line-number="5"><span class="co"># Check results</span></a>
<a class="sourceLine" id="cb51-6" data-line-number="6"><span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(fit.km)</a>
<a class="sourceLine" id="cb51-7" data-line-number="7"><span class="co"># Plot data</span></a>
<a class="sourceLine" id="cb51-8" data-line-number="8"><span class="kw"><a href="../reference/sensi_plot.html">sensi_plot</a></span>(fit.km)</a></code></pre></div>
</div>
</div>
<div id="using-sensiphy-with-other-packages-caper-phytools-gls" class="section level3">
<h3 class="hasAnchor">
<a href="#using-sensiphy-with-other-packages-caper-phytools-gls" class="anchor"></a>6. Using sensiPhy with other packages (caper, phytools, gls)</h3>
<p>sensiPhy leverages comparative methods implemented in specific R packages:<br>
1. <code>phylolm</code> for pgls regressions<br>
2. <code>phytools</code> for phylogenetic signal estimates<br>
3. <code>geiger</code> for macroevolutionary models (continuous and discrete trait evolution)</p>
<p>Nevertheless, users can still use sensiPhy to perform sensitivity analysis when they had performed their initial comparative analyses in another package.</p>
<p>For instance, if you have used <code>caper</code>, <code>phytools</code> or <code>gls</code> to fit your full models, you can still use <code>sensiPhy</code> to test the sensitivity of those models to multiple types of uncertainty. In order to do this, users will need to set arguments that mirror the specific parameters from their full analysis. For example, to compare results one needs to use the same evolutionary model in pgls (e.g “lambda”, “BM”, etc), or the same metric for phylogenetic signal tests (K or lambda). See below for some examples:</p>
<div id="pgls-regression" class="section level4">
<h4 class="hasAnchor">
<a href="#pgls-regression" class="anchor"></a>6.1 PGLS regression</h4>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb52-1" data-line-number="1"><span class="co">### prepare dataset for caper pgls:</span></a>
<a class="sourceLine" id="cb52-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(caper)</a>
<a class="sourceLine" id="cb52-3" data-line-number="3"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(phytools)</a>
<a class="sourceLine" id="cb52-4" data-line-number="4"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(phylolm)</a>
<a class="sourceLine" id="cb52-5" data-line-number="5"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(sensiPhy)</a>
<a class="sourceLine" id="cb52-6" data-line-number="6"><span class="co"># selected variables from dataset:</span></a>
<a class="sourceLine" id="cb52-7" data-line-number="7">alien.data &lt;-<span class="st"> </span>alien.data[<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"gestaLen"</span>, <span class="st">"adultMass"</span>)]</a>
<a class="sourceLine" id="cb52-8" data-line-number="8"></a>
<a class="sourceLine" id="cb52-9" data-line-number="9"><span class="co"># create variable with species names:</span></a>
<a class="sourceLine" id="cb52-10" data-line-number="10">alien.data<span class="op">$</span>sp &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(alien.data)</a>
<a class="sourceLine" id="cb52-11" data-line-number="11"></a>
<a class="sourceLine" id="cb52-12" data-line-number="12"><span class="co"># caper</span></a>
<a class="sourceLine" id="cb52-13" data-line-number="13"><span class="co"># prepare comparative dataset:</span></a>
<a class="sourceLine" id="cb52-14" data-line-number="14">comp.dat &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/caper/man/comparative.data.html">comparative.data</a></span>(<span class="dt">data =</span> alien.data, <span class="dt">phy =</span> alien.phy[[<span class="dv">1</span>]], </a>
<a class="sourceLine" id="cb52-15" data-line-number="15">                             <span class="dt">names.col =</span> <span class="st">"sp"</span>)</a>
<a class="sourceLine" id="cb52-16" data-line-number="16"><span class="co"># check comparative dataset:</span></a>
<a class="sourceLine" id="cb52-17" data-line-number="17"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(comp.dat)</a>
<a class="sourceLine" id="cb52-18" data-line-number="18"></a>
<a class="sourceLine" id="cb52-19" data-line-number="19"><span class="co">### Run PGLS analysis (full model)</span></a>
<a class="sourceLine" id="cb52-20" data-line-number="20"><span class="co"># using caper (lambda)</span></a>
<a class="sourceLine" id="cb52-21" data-line-number="21">fit.caper.lam &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/caper/man/pgls.html">pgls</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(gestaLen)<span class="op">~</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(adultMass), comp.dat, <span class="dt">lambda=</span><span class="st">"ML"</span>)</a>
<a class="sourceLine" id="cb52-22" data-line-number="22"><span class="kw"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span>(fit.caper.lam)</a>
<a class="sourceLine" id="cb52-23" data-line-number="23"></a>
<a class="sourceLine" id="cb52-24" data-line-number="24"><span class="co"># using caper (delta)</span></a>
<a class="sourceLine" id="cb52-25" data-line-number="25">fit.caper.del &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/caper/man/pgls.html">pgls</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(gestaLen)<span class="op">~</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(adultMass), comp.dat, <span class="dt">delta=</span><span class="st">"ML"</span>)</a>
<a class="sourceLine" id="cb52-26" data-line-number="26"><span class="kw"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span>(fit.caper.del)</a>
<a class="sourceLine" id="cb52-27" data-line-number="27"></a>
<a class="sourceLine" id="cb52-28" data-line-number="28"><span class="co"># using phylolm (lambda)</span></a>
<a class="sourceLine" id="cb52-29" data-line-number="29">fit.phylo.lam &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/phylolm/man/phylolm.html">phylolm</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(gestaLen)<span class="op">~</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(adultMass), comp.dat<span class="op">$</span>data, comp.dat<span class="op">$</span>phy,</a>
<a class="sourceLine" id="cb52-30" data-line-number="30">                 <span class="dt">model =</span> <span class="st">"lambda"</span>)</a>
<a class="sourceLine" id="cb52-31" data-line-number="31"><span class="kw"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span>(fit.phylo.lam)</a>
<a class="sourceLine" id="cb52-32" data-line-number="32"></a>
<a class="sourceLine" id="cb52-33" data-line-number="33"><span class="co"># using phylolm (del)</span></a>
<a class="sourceLine" id="cb52-34" data-line-number="34">fit.phylo.del &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/phylolm/man/phylolm.html">phylolm</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(gestaLen)<span class="op">~</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(adultMass), comp.dat<span class="op">$</span>data, comp.dat<span class="op">$</span>phy,</a>
<a class="sourceLine" id="cb52-35" data-line-number="35">                         <span class="dt">model =</span> <span class="st">"delta"</span>)</a>
<a class="sourceLine" id="cb52-36" data-line-number="36"><span class="kw"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span>(fit.phylo.del)</a>
<a class="sourceLine" id="cb52-37" data-line-number="37"></a>
<a class="sourceLine" id="cb52-38" data-line-number="38"><span class="co">### run sensitivity analysis with sensiPhy (influential species):</span></a>
<a class="sourceLine" id="cb52-39" data-line-number="39"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(sensiPhy)</a>
<a class="sourceLine" id="cb52-40" data-line-number="40"><span class="co"># run analysis (lambda):</span></a>
<a class="sourceLine" id="cb52-41" data-line-number="41">lam &lt;-<span class="st"> </span><span class="kw"><a href="../reference/influ_phylm.html">influ_phylm</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(gestaLen) <span class="op">~</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(adultMass), <span class="dt">phy =</span> comp.dat<span class="op">$</span>phy, </a>
<a class="sourceLine" id="cb52-42" data-line-number="42">                     <span class="dt">data =</span> comp.dat<span class="op">$</span>data, <span class="dt">model =</span> <span class="st">"lambda"</span>)</a>
<a class="sourceLine" id="cb52-43" data-line-number="43"><span class="co"># check full model estimates and compare to initial estimates:</span></a>
<a class="sourceLine" id="cb52-44" data-line-number="44">lam<span class="op">$</span>full.model.estimates</a>
<a class="sourceLine" id="cb52-45" data-line-number="45"><span class="co"># test for influential species:</span></a>
<a class="sourceLine" id="cb52-46" data-line-number="46"><span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(lam)</a>
<a class="sourceLine" id="cb52-47" data-line-number="47"></a>
<a class="sourceLine" id="cb52-48" data-line-number="48"><span class="co"># run analysis (delta):</span></a>
<a class="sourceLine" id="cb52-49" data-line-number="49">del &lt;-<span class="st"> </span><span class="kw"><a href="../reference/influ_phylm.html">influ_phylm</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(gestaLen) <span class="op">~</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(adultMass), <span class="dt">phy =</span> comp.dat<span class="op">$</span>phy, </a>
<a class="sourceLine" id="cb52-50" data-line-number="50">                     <span class="dt">data =</span> comp.dat<span class="op">$</span>data, <span class="dt">model =</span> <span class="st">"delta"</span>)</a>
<a class="sourceLine" id="cb52-51" data-line-number="51"><span class="co"># check full model estimates and compare to initial estimates:</span></a>
<a class="sourceLine" id="cb52-52" data-line-number="52">del<span class="op">$</span>full.model.estimates</a>
<a class="sourceLine" id="cb52-53" data-line-number="53"><span class="co"># test for influential species:</span></a>
<a class="sourceLine" id="cb52-54" data-line-number="54"><span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(del)</a></code></pre></div>
</div>
<div id="phylogenetic-signal" class="section level4">
<h4 class="hasAnchor">
<a href="#phylogenetic-signal" class="anchor"></a>6.2 phylogenetic signal</h4>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb53-1" data-line-number="1"><span class="co"># 2. phylogenetic signal:-------------------------------------------------------</span></a>
<a class="sourceLine" id="cb53-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(picante)</a>
<a class="sourceLine" id="cb53-3" data-line-number="3"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(phytools)</a>
<a class="sourceLine" id="cb53-4" data-line-number="4"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(sensiPhy)</a>
<a class="sourceLine" id="cb53-5" data-line-number="5"></a>
<a class="sourceLine" id="cb53-6" data-line-number="6"><span class="co">### Estimate phylogenetic signal:</span></a>
<a class="sourceLine" id="cb53-7" data-line-number="7"><span class="co"># using picante (K)</span></a>
<a class="sourceLine" id="cb53-8" data-line-number="8"><span class="kw"><a href="https://rdrr.io/pkg/picante/man/phylosignal.html">phylosignal</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(comp.dat<span class="op">$</span>data<span class="op">$</span>adultMass), comp.dat<span class="op">$</span>phy, <span class="dt">reps =</span> <span class="dv">1000</span>)</a>
<a class="sourceLine" id="cb53-9" data-line-number="9"></a>
<a class="sourceLine" id="cb53-10" data-line-number="10"><span class="co"># using phytools (K):</span></a>
<a class="sourceLine" id="cb53-11" data-line-number="11">phytools<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/phytools/man/phylosig.html">phylosig</a></span>(<span class="dt">x =</span> <span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(comp.dat<span class="op">$</span>data<span class="op">$</span>adultMass), <span class="dt">tree =</span> comp.dat<span class="op">$</span>phy, </a>
<a class="sourceLine" id="cb53-12" data-line-number="12">                   <span class="dt">nsim =</span> <span class="dv">1000</span>,</a>
<a class="sourceLine" id="cb53-13" data-line-number="13">                   <span class="dt">method =</span> <span class="st">"K"</span>, <span class="dt">test =</span> T)</a>
<a class="sourceLine" id="cb53-14" data-line-number="14"></a>
<a class="sourceLine" id="cb53-15" data-line-number="15"><span class="co"># using phytools (lambda):</span></a>
<a class="sourceLine" id="cb53-16" data-line-number="16">phytools<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/phytools/man/phylosig.html">phylosig</a></span>(<span class="dt">x =</span> <span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(comp.dat<span class="op">$</span>data<span class="op">$</span>adultMass), <span class="dt">tree =</span> comp.dat<span class="op">$</span>phy, </a>
<a class="sourceLine" id="cb53-17" data-line-number="17">                   <span class="dt">nsim =</span> <span class="dv">1000</span>,</a>
<a class="sourceLine" id="cb53-18" data-line-number="18">                   <span class="dt">method =</span> <span class="st">"lambda"</span>, <span class="dt">test =</span> T)</a>
<a class="sourceLine" id="cb53-19" data-line-number="19"></a>
<a class="sourceLine" id="cb53-20" data-line-number="20"><span class="co">### run sensitivity analysis with sensiPhy (influential species):</span></a>
<a class="sourceLine" id="cb53-21" data-line-number="21"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(sensiPhy)</a>
<a class="sourceLine" id="cb53-22" data-line-number="22"><span class="co"># Load data:</span></a>
<a class="sourceLine" id="cb53-23" data-line-number="23"><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(alien)</a>
<a class="sourceLine" id="cb53-24" data-line-number="24"><span class="co"># Logtransform data</span></a>
<a class="sourceLine" id="cb53-25" data-line-number="25">comp.dat<span class="op">$</span>data<span class="op">$</span>logMass &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(comp.dat<span class="op">$</span>data<span class="op">$</span>adultMass) </a>
<a class="sourceLine" id="cb53-26" data-line-number="26"></a>
<a class="sourceLine" id="cb53-27" data-line-number="27"><span class="co"># Run sensitivity analysis (K):</span></a>
<a class="sourceLine" id="cb53-28" data-line-number="28">influ.k &lt;-<span class="st"> </span><span class="kw"><a href="../reference/influ_physig.html">influ_physig</a></span>(<span class="st">"logMass"</span>, <span class="dt">data =</span> comp.dat<span class="op">$</span>data, <span class="dt">phy =</span> comp.dat<span class="op">$</span>phy, </a>
<a class="sourceLine" id="cb53-29" data-line-number="29">                      <span class="dt">method =</span> <span class="st">"K"</span>)</a>
<a class="sourceLine" id="cb53-30" data-line-number="30"><span class="co"># check full model estimates and compare to initial estimates:</span></a>
<a class="sourceLine" id="cb53-31" data-line-number="31">influ.k<span class="op">$</span>full.data.estimates</a>
<a class="sourceLine" id="cb53-32" data-line-number="32"><span class="co"># check for influential species:</span></a>
<a class="sourceLine" id="cb53-33" data-line-number="33"><span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(influ.k)</a>
<a class="sourceLine" id="cb53-34" data-line-number="34"></a>
<a class="sourceLine" id="cb53-35" data-line-number="35"><span class="co"># Run sensitivity analysis (lambda):</span></a>
<a class="sourceLine" id="cb53-36" data-line-number="36">influ.lam &lt;-<span class="st"> </span><span class="kw"><a href="../reference/influ_physig.html">influ_physig</a></span>(<span class="st">"logMass"</span>, <span class="dt">data =</span> comp.dat<span class="op">$</span>data, <span class="dt">phy =</span> comp.dat<span class="op">$</span>phy, </a>
<a class="sourceLine" id="cb53-37" data-line-number="37">                      <span class="dt">method =</span> <span class="st">"lambda"</span>)</a>
<a class="sourceLine" id="cb53-38" data-line-number="38"><span class="co"># check full model estimates and compare to initial estimates:</span></a>
<a class="sourceLine" id="cb53-39" data-line-number="39">influ.lam<span class="op">$</span>full.data.estimates</a>
<a class="sourceLine" id="cb53-40" data-line-number="40"><span class="co"># check for influential species:</span></a>
<a class="sourceLine" id="cb53-41" data-line-number="41"><span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(influ.lam)</a></code></pre></div>
</div>
</div>
<div id="how-long-does-it-take" class="section level3">
<h3 class="hasAnchor">
<a href="#how-long-does-it-take" class="anchor"></a>7. How long does it take?</h3>
<p>Although most functions implemented in sensiPhy are reasonably fast (runtime less them 1 min), it is important to be aware that some functions might take a long time to run. This is more likely when analyzing models with a high number of species (&gt;1000) or number of repetitions, and also when interacting two types of uncertainties (e.g. functions: <code>tree_clade</code> and <code>tree_samp</code>). To keep track of the time while running functions, we recommend users to set the argument <code>“track = TRUE”</code> which prints a progress bar and gives a good idea of how long the analysis will take before it finishes. As an indication, some examples of elapsed time on a standard desktop computer [Linux, Intel i7, 2.7GHz, 12GB ram] are presented below:</p>
<p><strong>Analyses with single uncertainty</strong>: <code>tree_phylm</code></p>
<table class="table">
<thead><tr class="header">
<th>function</th>
<th>N species</th>
<th>N trees</th>
<th>time</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>tree_phylm</td>
<td>100</td>
<td>30</td>
<td>~ 2 sec</td>
</tr>
<tr class="even">
<td>tree_phylm</td>
<td>100</td>
<td>100</td>
<td>~ 5 sec</td>
</tr>
</tbody>
</table>
<p><strong>Analyses with single uncertainty</strong>: <code>clade_phylm</code></p>
<table class="table">
<thead><tr class="header">
<th>function</th>
<th>N species</th>
<th>N sim</th>
<th>time</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>clade_phylm</td>
<td>100</td>
<td>100</td>
<td>~ 7 sec</td>
</tr>
<tr class="even">
<td>clade_phylm</td>
<td>100</td>
<td>300</td>
<td>~ 31 sec</td>
</tr>
<tr class="odd">
<td>clade_phylm</td>
<td>100</td>
<td>500</td>
<td>~ 61 sec</td>
</tr>
</tbody>
</table>
<p><strong>Analyses with single uncertainty</strong>: <code>samp_phylm</code></p>
<table class="table">
<thead><tr class="header">
<th>function</th>
<th>N species</th>
<th>N sim</th>
<th>time</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>samp_phylm</td>
<td>100</td>
<td>100</td>
<td>~ 11 sec</td>
</tr>
<tr class="even">
<td>samp_phylm</td>
<td>100</td>
<td>300</td>
<td>~ 25 sec</td>
</tr>
<tr class="odd">
<td>samp_phylm</td>
<td>100</td>
<td>500</td>
<td>~ 43 sec</td>
</tr>
<tr class="even">
<td>samp_phylm</td>
<td>500</td>
<td>100</td>
<td>~ 22 sec</td>
</tr>
<tr class="odd">
<td>samp_phylm</td>
<td>1000</td>
<td>100</td>
<td>~ 35 sec</td>
</tr>
</tbody>
</table>
<p><strong>Analyses with single uncertainty</strong>: <code>influ_phylm</code></p>
<table class="table">
<thead><tr class="header">
<th>function</th>
<th>N species</th>
<th>time</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>influ_phylm</td>
<td>100</td>
<td>~ 4 sec</td>
</tr>
<tr class="even">
<td>influ_phylm</td>
<td>500</td>
<td>~ 43 sec</td>
</tr>
<tr class="odd">
<td>influ_phylm</td>
<td>1000</td>
<td>~ 148 sec</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="how-to-support-sensiphy" class="section level2">
<h2 class="hasAnchor">
<a href="#how-to-support-sensiphy" class="anchor"></a>8. How to support sensiPhy</h2>
<p>Thanks for you interest in contributing with <code>sensiPhy</code>. First you need to register at <a href="https://github.com/">Github</a>. You can help developing <code>sensiPhy</code> in different ways:</p>
<div id="report-bugs-or-errors" class="section level3">
<h3 class="hasAnchor">
<a href="#report-bugs-or-errors" class="anchor"></a>8.1 Report bugs or errors</h3>
<p>If you have any problem running <code>sensiPhy</code> functions, please report the problem as a new <a href="https://github.com/paternogbc/sensiPhy/issues/new">issue</a>. To do this, follow the steps below:</p>
<ul>
<li>Create a new <a href="https://github.com/paternogbc/sensiPhy/issues/new">issue</a>
</li>
<li>Name this issue as "BUG: function_name</li>
<li>Write a small description about your problem/error</li>
<li>If possible, include a reproducible example using the R package <a href="https://github.com/tidyverse/reprex/blob/master/README.md">reprex</a>
</li>
</ul>
</div>
<div id="small-changes-in-sensiphy-documentation" class="section level3">
<h3 class="hasAnchor">
<a href="#small-changes-in-sensiphy-documentation" class="anchor"></a>8.2 Small changes in <code>sensiPhy</code> documentation</h3>
<p>If you find a typo on <code>sensiPhy</code> documentation or if you want to make a small change on any file, you can do it online. Search for the file you want to change at the <a href="https://github.com/paternogbc/sensiPhy">master branch</a>, then:</p>
<ul>
<li>Edit the file online</li>
<li>Save your change</li>
<li>Describe the changes you have made</li>
<li>Click <code>send a pull request</code>
</li>
</ul>
</div>
<div id="contribute-with-code" class="section level3">
<h3 class="hasAnchor">
<a href="#contribute-with-code" class="anchor"></a>8.3 Contribute with code</h3>
<p>If you want to make a bigger contribution and help us with <code>sensiPhy</code> code:</p>
<ol style="list-style-type: decimal">
<li>Fork it (<a href="https://github.com/paternogbc/sensiPhy/fork" class="uri">https://github.com/paternogbc/sensiPhy/fork</a>)</li>
<li>Create your feature branch (<code>git checkout -b my-new-feature</code>)</li>
<li>Commit your changes (<code>git commit -am 'Add some feature'</code>)</li>
<li>Push to the branch (<code>git push origin my-new-feature</code>)</li>
<li>Create a new Pull Request</li>
</ol>
</div>
<div id="new-ideas-or-suggestions" class="section level3">
<h3 class="hasAnchor">
<a href="#new-ideas-or-suggestions" class="anchor"></a>8.4 New ideas or suggestions?</h3>
<p>If you need to ask something via email, send to <a href="mailto:paternogbc@gmail.com">paternogbc@gmail.com</a></p>
</div>
<div id="code-of-conduct" class="section level3">
<h3 class="hasAnchor">
<a href="#code-of-conduct" class="anchor"></a>8.5 Code of Conduct</h3>
<p>Please note that this project is released with a Contributor Code of Conduct. By participating in this project you agree to abide by its <a href="https://github.com/paternogbc/sensiPhy/blob/master/CODE_OF_CONDUCT.md">terms</a>.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#sampling-uncertainty">1. Sampling uncertainty</a></li>
      <li><a href="#phylogenetic-uncertainty">2. Phylogenetic uncertainty</a></li>
      <li><a href="#data-uncertainty">3. Data uncertainty</a></li>
      <li><a href="#interacting-uncertainties">4. Interacting uncertainties</a></li>
      <li><a href="#additional-functions">5. Additional functions</a></li>
      <li><a href="#how-to-support-sensiphy">8. How to support sensiPhy</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Gustavo Paterno, Gijsbert Werner, Caterina Penone.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
