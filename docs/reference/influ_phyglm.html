<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Influential species detection - Phylogenetic Logistic Regression — influ_phyglm • sensiPhy</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Influential species detection - Phylogenetic Logistic Regression — influ_phyglm" />
<meta property="og:description" content="Performs leave-one-out deletion analysis for phylogenetic logistic regression,
and detects influential species." />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">sensiPhy</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.8.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/sensiPhy_vignette.html">sensiPhy: R-package for sensitivity analysis in phylogenetic comparative methods.</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/paternogbc/sensiPhy">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Influential species detection - Phylogenetic Logistic Regression</h1>
    <small class="dont-index">Source: <a href='https://github.com/paternogbc/sensiPhy/blob/master/R/influ_phyglm.R'><code>R/influ_phyglm.R</code></a></small>
    <div class="hidden name"><code>influ_phyglm.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Performs leave-one-out deletion analysis for phylogenetic logistic regression,
and detects influential species.</p>
    </div>

    <pre class="usage"><span class='fu'>influ_phyglm</span>(<span class='no'>formula</span>, <span class='no'>data</span>, <span class='no'>phy</span>, <span class='kw'>btol</span> <span class='kw'>=</span> <span class='fl'>50</span>, <span class='kw'>cutoff</span> <span class='kw'>=</span> <span class='fl'>2</span>, <span class='kw'>track</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='no'>...</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>formula</th>
      <td><p>The model formula</p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p>Data frame containing species traits with row names matching tips
in <code>phy</code>.</p></td>
    </tr>
    <tr>
      <th>phy</th>
      <td><p>A phylogeny (class 'phylo') matching <code>data</code>.</p></td>
    </tr>
    <tr>
      <th>btol</th>
      <td><p>Bound on searching space. For details see <code>phyloglm</code></p></td>
    </tr>
    <tr>
      <th>cutoff</th>
      <td><p>The cutoff value used to identify for influential species
(see Details)</p></td>
    </tr>
    <tr>
      <th>track</th>
      <td><p>Print a report tracking function progress (default = TRUE)</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Further arguments to be passed to <code>phyloglm</code></p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>The function <code>influ_phyglm</code> returns a list with the following
components:</p>
<p><code>cutoff</code>: The value selected for <code>cutoff</code></p>
<p><code>formula</code>: The formula</p>
<p><code>full.model.estimates</code>: Coefficients, aic and the optimised
value of the phylogenetic parameter (i.e. <code>alpha</code>) for the full model
without deleted species.</p>
<p><code>influential_species</code>: List of influential species, both
based on standardised difference in intercept and in the slope of the
regression. Species are ordered from most influential to less influential and
only include species with a standardised difference &gt; <code>cutoff</code>.</p>
<p><code>sensi.estimates</code>: A data frame with all simulation
estimates. Each row represents a deleted clade. Columns report the calculated
regression intercept (<code>intercept</code>), difference between simulation
intercept and full model intercept (<code>DIFintercept</code>), the standardised
difference (<code>sDIFintercept</code>), the percentage of change in intercept compared
to the full model (<code>intercept.perc</code>) and intercept p-value
(<code>pval.intercept</code>). All these parameters are also reported for the regression
slope (<code>DIFestimate</code> etc.). Additionally, model aic value (<code>AIC</code>) and
the optimised value (<code>optpar</code>) of the phylogenetic parameter
(i.e. <code>alpha</code>) are reported.</p>
<p><code>data</code>: Original full dataset.</p>
<p><code>errors</code>: Species where deletion resulted in errors.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This function sequentially removes one species at a time, fits a phylogenetic
logistic regression model using <code><a href='https://rdrr.io/pkg/phylolm/man/phyloglm.html'>phyloglm</a></code>, stores the
results and detects influential species.</p>
<p>Currently only logistic regression using the "logistic_MPLE"-method from
<code>phyloglm</code> is implemented.</p>
<p><code>influ_phyglm</code> detects influential species based on the standardised
difference in intercept and/or slope when removing a given species compared
to the full model including all species. Species with a standardised difference
above the value of <code>cutoff</code> are identified as influential. The default
value for the cutoff is 2 standardised differences change.</p>
<p>Currently, this function can only implement simple logistic models (i.e. \(trait~
predictor\)). In the future we will implement more complex models.</p>
<p>Output can be visualised using <code>sensi_plot</code>.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Paterno, G. B., Penone, C. Werner, G. D. A. 
<a href='http://doi.wiley.com/10.1111/2041-210X.12990'>sensiPhy: 
An r-package for sensitivity analysis in phylogenetic 
comparative methods.</a> Methods in Ecology and Evolution 
2018, 9(6):1461-1467.</p>
<p>Ho, L. S. T. and Ane, C. 2014. "A linear-time algorithm for 
Gaussian and non-Gaussian trait evolution models". Systematic Biology 63(3):397-408.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='https://rdrr.io/pkg/phylolm/man/phyloglm.html'>phyloglm</a></code>, <code><a href='samp_phyglm.html'>samp_phyglm</a></code>,
<code><a href='influ_phylm.html'>influ_phylm</a></code>, <code><a href='sensi_plot.html'>sensi_plot</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># Simulate Data:</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span>(<span class='fl'>6987</span>)
<span class='no'>phy</span> <span class='kw'>=</span> <span class='fu'>rtree</span>(<span class='fl'>100</span>)
<span class='no'>x</span> <span class='kw'>=</span> <span class='fu'>rTrait</span>(<span class='kw'>n</span><span class='kw'>=</span><span class='fl'>1</span>,<span class='kw'>phy</span><span class='kw'>=</span><span class='no'>phy</span>)
<span class='no'>X</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>1</span>,<span class='fl'>100</span>),<span class='no'>x</span>)
<span class='no'>y</span> <span class='kw'>=</span> <span class='fu'>rbinTrait</span>(<span class='kw'>n</span><span class='kw'>=</span><span class='fl'>1</span>,<span class='kw'>phy</span><span class='kw'>=</span><span class='no'>phy</span>, <span class='kw'>beta</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(-<span class='fl'>1</span>,<span class='fl'>0.5</span>), <span class='kw'>alpha</span><span class='kw'>=</span><span class='fl'>.7</span> ,<span class='kw'>X</span><span class='kw'>=</span><span class='no'>X</span>)
<span class='no'>dat</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span>(<span class='no'>y</span>, <span class='no'>x</span>)
<span class='co'># Run sensitivity analysis:</span>
<span class='no'>influ</span> <span class='kw'>&lt;-</span> <span class='fu'>influ_phyglm</span>(<span class='no'>y</span> ~ <span class='no'>x</span>, <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>dat</span>, <span class='kw'>phy</span> <span class='kw'>=</span> <span class='no'>phy</span>)</div><div class='output co'>#&gt; <span class='message'>Used dataset has  100  species that match data and phylogeny</span></div><div class='output co'>#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |=                                                                     |   1%  |                                                                              |=                                                                     |   2%  |                                                                              |==                                                                    |   3%  |                                                                              |===                                                                   |   4%  |                                                                              |====                                                                  |   5%  |                                                                              |====                                                                  |   6%  |                                                                              |=====                                                                 |   7%  |                                                                              |======                                                                |   8%  |                                                                              |======                                                                |   9%  |                                                                              |=======                                                               |  10%  |                                                                              |========                                                              |  11%  |                                                                              |========                                                              |  12%  |                                                                              |=========                                                             |  13%  |                                                                              |==========                                                            |  14%  |                                                                              |==========                                                            |  15%  |                                                                              |===========                                                           |  16%  |                                                                              |============                                                          |  17%  |                                                                              |=============                                                         |  18%  |                                                                              |=============                                                         |  19%  |                                                                              |==============                                                        |  20%  |                                                                              |===============                                                       |  21%  |                                                                              |===============                                                       |  22%  |                                                                              |================                                                      |  23%  |                                                                              |=================                                                     |  24%  |                                                                              |==================                                                    |  25%  |                                                                              |==================                                                    |  26%  |                                                                              |===================                                                   |  27%  |                                                                              |====================                                                  |  28%  |                                                                              |====================                                                  |  29%  |                                                                              |=====================                                                 |  30%  |                                                                              |======================                                                |  31%  |                                                                              |======================                                                |  32%  |                                                                              |=======================                                               |  33%  |                                                                              |========================                                              |  34%  |                                                                              |========================                                              |  35%  |                                                                              |=========================                                             |  36%  |                                                                              |==========================                                            |  37%  |                                                                              |===========================                                           |  38%  |                                                                              |===========================                                           |  39%  |                                                                              |============================                                          |  40%  |                                                                              |=============================                                         |  41%  |                                                                              |=============================                                         |  42%  |                                                                              |==============================                                        |  43%  |                                                                              |===============================                                       |  44%  |                                                                              |================================                                      |  45%  |                                                                              |================================                                      |  46%  |                                                                              |=================================                                     |  47%  |                                                                              |==================================                                    |  48%  |                                                                              |==================================                                    |  49%  |                                                                              |===================================                                   |  50%  |                                                                              |====================================                                  |  51%  |                                                                              |====================================                                  |  52%  |                                                                              |=====================================                                 |  53%  |                                                                              |======================================                                |  54%  |                                                                              |======================================                                |  55%  |                                                                              |=======================================                               |  56%  |                                                                              |========================================                              |  57%  |                                                                              |=========================================                             |  58%  |                                                                              |=========================================                             |  59%  |                                                                              |==========================================                            |  60%  |                                                                              |===========================================                           |  61%  |                                                                              |===========================================                           |  62%  |                                                                              |============================================                          |  63%  |                                                                              |=============================================                         |  64%  |                                                                              |==============================================                        |  65%  |                                                                              |==============================================                        |  66%  |                                                                              |===============================================                       |  67%  |                                                                              |================================================                      |  68%  |                                                                              |================================================                      |  69%  |                                                                              |=================================================                     |  70%  |                                                                              |==================================================                    |  71%  |                                                                              |==================================================                    |  72%  |                                                                              |===================================================                   |  73%  |                                                                              |====================================================                  |  74%  |                                                                              |====================================================                  |  75%  |                                                                              |=====================================================                 |  76%  |                                                                              |======================================================                |  77%  |                                                                              |=======================================================               |  78%  |                                                                              |=======================================================               |  79%  |                                                                              |========================================================              |  80%  |                                                                              |=========================================================             |  81%  |                                                                              |=========================================================             |  82%  |                                                                              |==========================================================            |  83%  |                                                                              |===========================================================           |  84%  |                                                                              |============================================================          |  85%  |                                                                              |============================================================          |  86%  |                                                                              |=============================================================         |  87%  |                                                                              |==============================================================        |  88%  |                                                                              |==============================================================        |  89%  |                                                                              |===============================================================       |  90%  |                                                                              |================================================================      |  91%  |                                                                              |================================================================      |  92%  |                                                                              |=================================================================     |  93%  |                                                                              |==================================================================    |  94%  |                                                                              |==================================================================    |  95%  |                                                                              |===================================================================   |  96%  |                                                                              |====================================================================  |  97%  |                                                                              |===================================================================== |  98%  |                                                                              |===================================================================== |  99%  |                                                                              |======================================================================| 100%</div><div class='input'><span class='co'># To check summary results and most influential species:</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>influ</span>)</div><div class='output co'>#&gt; $`Influential species for the Estimate`
#&gt; [1] "t75" "t63" "t61" "t39"
#&gt; 
#&gt; $Estimate
#&gt;   Species removed  Estimate DIFestimate Change(%)         Pval
#&gt; 1             t75 0.9251492  0.09677685      11.7 4.718492e-06
#&gt; 2             t63 0.8985843  0.07021189       8.5 5.810063e-06
#&gt; 3             t61 0.8915019  0.06312951       7.6 5.945524e-06
#&gt; 4             t39 0.8655150  0.03714260       4.5 7.261238e-06
#&gt; 
#&gt; $`Influential species for the Intercept`
#&gt; [1] "t62" "t63" "t4"  "t27" "t75" "t30" "t3" 
#&gt; 
#&gt; $Intercept
#&gt;   Species removed Intercept DIFintercept Change(%)         Pval
#&gt; 1             t62 -1.439720  -0.13550811      10.4 0.0008466443
#&gt; 2             t63 -1.435110  -0.13089888      10.0 0.0004590783
#&gt; 3              t4 -1.411781  -0.10756926       8.2 0.0004793575
#&gt; 4             t27 -1.406977  -0.10276506       7.9 0.0004522071
#&gt; 5             t75 -1.395818  -0.09160623       7.0 0.0007571041
#&gt; 6             t30 -1.395531  -0.09131921       7.0 0.0004519752
#&gt; 7              t3 -1.378665  -0.07445391       5.7 0.0005947404
#&gt; </div><div class='input'><span class='co'># Visual diagnostics for clade removal:</span>
<span class='fu'><a href='sensi_plot.html'>sensi_plot</a></span>(<span class='no'>influ</span>)</div><div class='img'><img src='influ_phyglm-1.png' alt='' width='700' height='433' /></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#details">Details</a></li>
      <li><a href="#references">References</a></li>
      <li><a href="#see-also">See also</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    <p>Gustavo Paterno &amp; Gijsbert D.A. Werner</p>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Gustavo Paterno, Gijsbert Werner, Caterina Penone.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


