<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Species Sampling uncertainty - Trait Evolution Discrete Characters — samp_discrete • sensiPhy</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Species Sampling uncertainty - Trait Evolution Discrete Characters — samp_discrete" />
<meta property="og:description" content="Fits models for trait evolution of discrete (binary) characters, 
evaluating sampling uncertainty." />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">sensiPhy</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.8.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/sensiPhy_vignette.html">sensiPhy: R-package for sensitivity analysis in phylogenetic comparative methods.</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/paternogbc/sensiPhy">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Species Sampling uncertainty - Trait Evolution Discrete Characters</h1>
    <small class="dont-index">Source: <a href='https://github.com/paternogbc/sensiPhy/blob/master/R/samp_Discrete.R'><code>R/samp_Discrete.R</code></a></small>
    <div class="hidden name"><code>samp_discrete.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Fits models for trait evolution of discrete (binary) characters, 
evaluating sampling uncertainty.</p>
    </div>

    <pre class="usage"><span class='fu'>samp_discrete</span>(
  <span class='no'>data</span>,
  <span class='no'>phy</span>,
  <span class='kw'>n.sim</span> <span class='kw'>=</span> <span class='fl'>30</span>,
  <span class='kw'>breaks</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>0.1</span>, <span class='fl'>0.5</span>, <span class='fl'>0.1</span>),
  <span class='no'>model</span>,
  <span class='kw'>transform</span> <span class='kw'>=</span> <span class='st'>"none"</span>,
  <span class='kw'>bounds</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(),
  <span class='kw'>n.cores</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>track</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='no'>...</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>data</th>
      <td><p>Data vector for a single binary trait, with names matching tips in <code>phy</code>.</p></td>
    </tr>
    <tr>
      <th>phy</th>
      <td><p>A phylogeny (class 'phylo') matching <code>data</code>.</p></td>
    </tr>
    <tr>
      <th>n.sim</th>
      <td><p>The number of times species are randomly deleted for each <code>break</code>.</p></td>
    </tr>
    <tr>
      <th>breaks</th>
      <td><p>A vector containing the percentages of species to remove.</p></td>
    </tr>
    <tr>
      <th>model</th>
      <td><p>The Mkn model to use (see Details).</p></td>
    </tr>
    <tr>
      <th>transform</th>
      <td><p>The evolutionary model to transform the tree (see Details). Default is <code>none</code>.</p></td>
    </tr>
    <tr>
      <th>bounds</th>
      <td><p>settings to constrain parameter estimates. See <code><a href='https://rdrr.io/pkg/geiger/man/fitDiscrete.html'>fitDiscrete</a></code></p></td>
    </tr>
    <tr>
      <th>n.cores</th>
      <td><p>number of cores to use. If 'NULL', number of cores is detected.</p></td>
    </tr>
    <tr>
      <th>track</th>
      <td><p>Print a report tracking function progress (default = TRUE)</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Further arguments to be passed to <code><a href='https://rdrr.io/pkg/geiger/man/fitDiscrete.html'>fitDiscrete</a></code></p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>The function <code>tree_discrete</code> returns a list with the following
components:</p>
<p><code>call</code>: The function call</p>
<p><code>data</code>: The original full data vector</p>
<p><code>optpar</code>: Transformation parameter used (e.g. <code>lambda</code>, <code>kappa</code> etc.)</p>
<p><code>full.model.estimates</code>: Parameter estimates (transition rates q12 and q21), 
AICc and the optimised value of the phylogenetic transformation parameter (e.g. <code>lambda</code>) 
for the full model without deleted species.</p>
<p><code>break.summary.tab</code>: Summary per <code>break</code> of the mean and median effects 
of species removal on percentage and absolute change in parameters q12 and q21.</p>
<p><code>sensi.estimates</code>: Parameter estimates (transition rates q12 and q21),(percentual) difference 
in parameter estimate compared to the full model (DIFq12, sigsq.q12,sDIFq12, DIFq21, optpar.q21,sDIFq21),  
AICc and the optimised value of the phylogenetic transformation parameter (e.g. <code>lambda</code>) 
for each analysis with a species deleted.</p>
<p><code>optpar</code>: Transformation parameter used (e.g. <code>lambda</code>, <code>kappa</code> etc.)</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This function randomly removes a given percentage of species (controlled by <code>breaks</code>),  
fits different models of discrete character evolution using <code><a href='https://rdrr.io/pkg/geiger/man/fitDiscrete.html'>fitDiscrete</a></code>, 
repeats this this many times (controlled by <code>n.sim</code>), stores the results and calculates 
the effects on model parameters Currently, only binary discrete traits are supported.</p>
<p>Different character model from <code>fitDiscrete</code> can be used, including <code>ER</code> (equal-rates), 
<code>SYM</code> (symmetric), <code>ARD</code> (all-rates-different) and <code>meristic</code> (stepwise fashion).</p>
<p>Transformations to the phylogenetic tree from <code>fitDiscrete</code> can be used, i.e. <code>none</code>,
<code>EB</code>, <code>lambda</code>, <code>kappa</code> and<code>delta</code>.</p>
<p>See <code><a href='https://rdrr.io/pkg/geiger/man/fitDiscrete.html'>fitDiscrete</a></code> for more details on character models and tree transformations.</p>
<p>Output can be visualised using <code>sensi_plot</code>.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Paterno, G. B., Penone, C. Werner, G. D. A. 
<a href='http://doi.wiley.com/10.1111/2041-210X.12990'>sensiPhy: 
An r-package for sensitivity analysis in phylogenetic 
comparative methods.</a> Methods in Ecology and Evolution 
2018, 9(6):1461-1467</p>
<p>Yang Z. 2006. Computational Molecular Evolution. Oxford University Press: Oxford.</p>
<p>Harmon Luke J, Jason T Weir, Chad D Brock, Richard E Glor, and Wendell Challenger. 2008.
GEIGER: investigating evolutionary radiations. Bioinformatics 24:129-131.</p>
<p>Werner, G.D.A., Cornwell, W.K., Sprent, J.I., Kattge, J. &amp; Kiers, E.T. (2014). 
A single evolutionary innovation drives the deep evolution of symbiotic N2-fixation in angiosperms. Nature Communications, 5, 4087.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='https://rdrr.io/pkg/geiger/man/fitDiscrete.html'>fitDiscrete</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='kw'>if</span> (<span class='fl'>FALSE</span>) {
<span class='co'>#Load data:</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='st'>"primates"</span>)
<span class='co'>#Create a binary trait factor </span>
<span class='no'>adultMass_binary</span><span class='kw'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span>(<span class='no'>primates</span>$<span class='no'>data</span>$<span class='no'>adultMass</span> <span class='kw'>&gt;</span> <span class='fl'>7350</span>, <span class='st'>"big"</span>, <span class='st'>"small"</span>)
<span class='no'>adultMass_binary</span><span class='kw'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/factor.html'>as.factor</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/factor.html'>as.factor</a></span>(<span class='no'>adultMass_binary</span>))
<span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span>(<span class='no'>adultMass_binary</span>)<span class='kw'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span>(<span class='no'>primates</span>$<span class='no'>data</span>)
<span class='co'>#Model trait evolution accounting for sampling size </span>
<span class='no'>samp_binary</span><span class='kw'>&lt;-</span><span class='fu'>samp_discrete</span>(<span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>adultMass_binary</span>,<span class='kw'>phy</span> <span class='kw'>=</span> <span class='no'>primates</span>$<span class='no'>phy</span><span class='kw'>[[</span><span class='fl'>1</span>]],
<span class='kw'>n.sim</span><span class='kw'>=</span><span class='fl'>25</span>,<span class='kw'>breaks</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>.1</span>,<span class='fl'>.3</span>,<span class='fl'>.1</span>),<span class='kw'>model</span> <span class='kw'>=</span> <span class='st'>"SYM"</span>,<span class='kw'>transform</span> <span class='kw'>=</span> <span class='st'>"none"</span>,<span class='kw'>n.cores</span> <span class='kw'>=</span> <span class='fl'>2</span>,<span class='kw'>track</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)
<span class='co'>#Print summary statistics</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>samp_binary</span>)
<span class='fu'><a href='sensi_plot.html'>sensi_plot</a></span>(<span class='no'>samp_binary</span>)
<span class='fu'><a href='sensi_plot.html'>sensi_plot</a></span>(<span class='no'>samp_binary</span>,<span class='kw'>graphs</span><span class='kw'>=</span><span class='fl'>1</span>)
<span class='fu'><a href='sensi_plot.html'>sensi_plot</a></span>(<span class='no'>samp_binary</span>,<span class='kw'>graphs</span><span class='kw'>=</span><span class='fl'>2</span>)
<span class='co'>#Use a different evolutionary model or transformation </span>
<span class='no'>samp_binary2</span><span class='kw'>&lt;-</span><span class='fu'>samp_discrete</span>(<span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>adultMass_binary</span>,<span class='kw'>phy</span> <span class='kw'>=</span> <span class='no'>primates</span>$<span class='no'>phy</span><span class='kw'>[[</span><span class='fl'>1</span>]],
<span class='kw'>n.sim</span><span class='kw'>=</span><span class='fl'>25</span>,<span class='kw'>breaks</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>.1</span>,<span class='fl'>.3</span>,<span class='fl'>.1</span>),<span class='kw'>model</span> <span class='kw'>=</span> <span class='st'>"ARD"</span>,<span class='kw'>transform</span> <span class='kw'>=</span> <span class='st'>"lambda"</span>,<span class='kw'>n.cores</span> <span class='kw'>=</span> <span class='fl'>2</span>,<span class='kw'>track</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>samp_binary2</span>)
<span class='fu'><a href='sensi_plot.html'>sensi_plot</a></span>(<span class='no'>samp_binary2</span>)
<span class='fu'><a href='sensi_plot.html'>sensi_plot</a></span>(<span class='no'>samp_binary2</span>,<span class='kw'>graphs</span><span class='kw'>=</span><span class='fl'>1</span>)
<span class='fu'><a href='sensi_plot.html'>sensi_plot</a></span>(<span class='no'>samp_binary2</span>,<span class='kw'>graphs</span><span class='kw'>=</span><span class='fl'>3</span>)
}</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#details">Details</a></li>
      <li><a href="#references">References</a></li>
      <li><a href="#see-also">See also</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    <p>Gijsbert Werner &amp; Gustavo Paterno</p>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Gustavo Paterno, Gijsbert Werner, Caterina Penone.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


