<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Match data and phylogeny based on model formula — match_dataphy • sensiPhy</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Match data and phylogeny based on model formula — match_dataphy" />
<meta property="og:description" content="Combines phylogeny and data to ensure that tips in phylogeny match data and that observations
with missing values are removed. This function uses variables provided in the 
`formula` argument to:
Remove NA`s:    Check if there is any row with NA in the variables included in 
 the formula. All rows containing NA will be removed from the data
Match data and phy:    Check if tips from phylogeny match rownames in
 data. Tips not present in data and phy will be removed from the phylogeny and
 data
Return matched data and phy:    The returned data
 has no NA in the variables included in `formula` and only rows that match phylogeny
 tips. Returned phy has only tips that match data
Used internally in samp_phylm, samp_phyglm, clade_phylm,
 clade_phyglm, intra_phylm, intra_phyglm, tree_phylm,
 tree_phyglm and all function analysing interactions.
 Users can also directly use this function to combine a phylogeny and a dataset." />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">sensiPhy</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.8.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/sensiPhy_vignette.html">sensiPhy: R-package for sensitivity analysis in phylogenetic comparative methods.</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/paternogbc/sensiPhy">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Match data and phylogeny based on model formula</h1>
    <small class="dont-index">Source: <a href='https://github.com/paternogbc/sensiPhy/blob/master/R/match_dataphy.R'><code>R/match_dataphy.R</code></a></small>
    <div class="hidden name"><code>match_dataphy.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Combines phylogeny and data to ensure that tips in phylogeny match data and that observations
with missing values are removed. This function uses variables provided in the 
`formula` argument to:</p><ul>
<li><p>Remove NA`s:    Check if there is any row with NA in the variables included in 
 the formula. All rows containing NA will be removed from the data</p></li>
<li><p>Match data and phy:    Check if tips from phylogeny match rownames in
 data. Tips not present in data and phy will be removed from the phylogeny and
 data</p></li>
<li><p>Return matched data and phy:    The returned data
 has no NA in the variables included in `formula` and only rows that match phylogeny
 tips. Returned phy has only tips that match data</p></li>
</ul><p>Used internally in <code><a href='samp_phylm.html'>samp_phylm</a></code>, <code><a href='samp_phyglm.html'>samp_phyglm</a></code>, <code><a href='clade_phylm.html'>clade_phylm</a></code>,
 <code><a href='clade_phyglm.html'>clade_phyglm</a></code>, <code><a href='intra_phylm.html'>intra_phylm</a></code>, <code><a href='intra_phyglm.html'>intra_phyglm</a></code>, <code><a href='tree_phylm.html'>tree_phylm</a></code>,
 <code><a href='tree_phyglm.html'>tree_phyglm</a></code> and all function analysing interactions.
 Users can also directly use this function to combine a phylogeny and a dataset.</p>
    </div>

    <pre class="usage"><span class='fu'>match_dataphy</span>(<span class='no'>formula</span>, <span class='no'>data</span>, <span class='no'>phy</span>, <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='no'>...</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>formula</th>
      <td><p>The model formula</p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p>Data frame containing species traits with row names matching tips
in <code>phy</code>.</p></td>
    </tr>
    <tr>
      <th>phy</th>
      <td><p>A phylogeny (class 'phylo' or 'multiphylo')</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>Print the number of species that match data and phylogeny and warnings. We highly recommend to use the 
default (verbose = T), but warning and information can be silenced for advanced use.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Further arguments to be passed to <code>match_dataphy</code></p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>The function <code>match_dataphy</code> returns a list with the following
components:</p>
<p><code>data</code>: Cropped dataset matching phylogeny</p>
<p><code>phy</code>: Cropped phylogeny matching data</p>
<p><code>dropped</code>: Species dropped from phylogeny and removed from data.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This function uses all variables provided in the `formula` to match
data and phylogeny. To avoid cropping the full dataset, `match_dataphy` searches
for NA values only on variables provided by formula. Missing values on 
other variables, not included in `formula`, will not be removed from data.
If no species names are provided as row names in the dataset but the number of rows in the dataset
is the same as the number of tips in the phylogeny, the function assumes that the dataset and the 
phylogeny are in the same order.</p>
<p>This ensures consistency between data and phylogeny only for the variables 
that are being used in the model (set by `formula`).</p>
<p>If phy is a 'multiphylo' object, all phylogenies will be cropped
to match data. But the dataset order will only match the first tree provided.
The returned phylogeny will be a 'multiphylo' object.</p>
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>If tips are removed from the phylogeny and data or if rows containing
missing values are removed from data, a message will be printed with the 
details. Further, the final number of species that match data and phy will
always be reported by a message.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>This function is largely inspired by the function <code>comparative.data</code> in caper package
David Orme, Rob Freckleton, Gavin Thomas, Thomas Petzoldt, Susanne Fritz, Nick Isaac and Will Pearse
(2013). caper: Comparative Analyses of Phylogenetics and Evolution in R. R package version 0.5.2.
http://CRAN.R-project.org/package=caper</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># Load data:</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>alien</span>)
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span>(<span class='no'>alien</span>$<span class='no'>data</span>)</div><div class='output co'>#&gt;                                     family adultMass gestaLen homeRange
#&gt; Tachyglossus_aculeatus      Tachyglossidae  4020.767   28.375 0.9991117
#&gt; Ornithorhynchus_anatinus Ornithorhynchidae  1458.208   15.000 0.1120000
#&gt; Ondatra_zibethicus              Cricetidae  1135.014   27.100 0.0044500
#&gt; Mesocricetus_auratus            Cricetidae    97.125   15.500        NA
#&gt; Castor_canadensis               Castoridae 18085.634  110.000        NA
#&gt; Myocastor_coypus             Myocastoridae  6135.768  131.737 0.0376000
#&gt;                             SD_mass  SD_gesta   SD_range
#&gt; Tachyglossus_aculeatus   1218.29240  4.199500 0.79224190
#&gt; Ornithorhynchus_anatinus  180.81779  2.160000 0.04300000
#&gt; Ondatra_zibethicus        388.17479  3.333300 0.00000000
#&gt; Mesocricetus_auratus       12.52913  0.496000         NA
#&gt; Castor_canadensis        2875.61581 13.090000         NA
#&gt; Myocastor_coypus          546.08335  3.425162 0.01567712</div><div class='input'><span class='co'># Match data and phy based on model formula:</span>
<span class='no'>comp.data</span> <span class='kw'>&lt;-</span> <span class='fu'>match_dataphy</span>(<span class='no'>gestaLen</span> ~ <span class='no'>homeRange</span>, <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>alien</span>$<span class='no'>data</span>, <span class='no'>alien</span>$<span class='no'>phy</span><span class='kw'>[[</span><span class='fl'>1</span>]])</div><div class='output co'>#&gt; <span class='warning'>Warning: NA's in response or predictor, rows with NA's were removed</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Some phylo tips do not match species in data (this can be due to NA removal) species were dropped from phylogeny or data</span></div><div class='output co'>#&gt; <span class='message'>Used dataset has  49  species that match data and phylogeny</span></div><div class='input'><span class='co'># Check data:</span>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span>(<span class='no'>comp.data</span>$<span class='no'>data</span>)</div><div class='output co'>#&gt;                                     family adultMass gestaLen  homeRange
#&gt; Tachyglossus_aculeatus      Tachyglossidae  4020.767   28.375 0.99911167
#&gt; Ornithorhynchus_anatinus Ornithorhynchidae  1458.208   15.000 0.11200000
#&gt; Ondatra_zibethicus              Cricetidae  1135.014   27.100 0.00445000
#&gt; Myocastor_coypus             Myocastoridae  6135.768  131.737 0.03760000
#&gt; Marmota_monax                    Sciuridae  3747.182   31.600 0.03335818
#&gt; Tamiasciurus_hudsonicus          Sciuridae   209.452   35.724 0.01173571
#&gt;                             SD_mass SD_gesta    SD_range
#&gt; Tachyglossus_aculeatus   1218.29240 4.199500 0.792241901
#&gt; Ornithorhynchus_anatinus  180.81779 2.160000 0.043000000
#&gt; Ondatra_zibethicus        388.17479 3.333300 0.000000000
#&gt; Myocastor_coypus          546.08335 3.425162 0.015677117
#&gt; Marmota_monax             528.35266 2.275200 0.042975197
#&gt; Tamiasciurus_hudsonicus    23.66808 3.072264 0.007209057</div><div class='input'><span class='co'># Check phy:</span>
<span class='no'>comp.data</span>$<span class='no'>phy</span></div><div class='output co'>#&gt; 
#&gt; Phylogenetic tree with 49 tips and 48 internal nodes.
#&gt; 
#&gt; Tip labels:
#&gt; 	Tachyglossus_aculeatus, Ornithorhynchus_anatinus, Ondatra_zibethicus, Myocastor_coypus, Marmota_monax, Tamiasciurus_hudsonicus, ...
#&gt; 
#&gt; Rooted; includes branch lengths.</div><div class='input'><span class='co'># See species dropped from phy or data:</span>
<span class='no'>comp.data</span>$<span class='no'>dropped</span></div><div class='output co'>#&gt;  [1] "Mesocricetus_auratus"     "Castor_canadensis"       
#&gt;  [3] "Hystrix_brachyura"        "Chinchilla_lanigera"     
#&gt;  [5] "Marmota_bobak"            "Tamias_townsendii"       
#&gt;  [7] "Atlantoxerus_getulus"     "Sciurus_niger"           
#&gt;  [9] "Sciurus_aureogaster"      "Oryctolagus_cuniculus"   
#&gt; [11] "Macaca_arctoides"         "Macaca_mulatta"          
#&gt; [13] "Macaca_fascicularis"      "Ovis_ammon"              
#&gt; [15] "Ovis_aries"               "Hemitragus_jemlahicus"   
#&gt; [17] "Capra_ibex"               "Rupicapra_rupicapra"     
#&gt; [19] "Ovibos_moschatus"         "Gazella_subgutturosa"    
#&gt; [21] "Saiga_tatarica"           "Bubalus_bubalis"         
#&gt; [23] "Tragelaphus_strepsiceros" "Capreolus_capreolus"     
#&gt; [25] "Rangifer_tarandus"        "Rusa_timorensis"         
#&gt; [27] "Cervus_elaphus"           "Rusa_unicolor"           
#&gt; [29] "Camelus_bactrianus"       "Equus_hemionus"          
#&gt; [31] "Mustela_sibirica"         "Mustela_lutreola"        
#&gt; [33] "Neovison_vison"           "Nasua_nasua"             
#&gt; [35] "Lycalopex_griseus"        "Felis_catus"             
#&gt; [37] "Pseudocheirus_peregrinus" "Bettongia_lesueur"       
#&gt; [39] "Macropus_eugenii"         "Macropus_parma"          
#&gt; [41] "Petrogale_lateralis"      "Petrogale_penicillata"   
#&gt; [43] "Thylogale_billardierii"   "Potorous_tridactylus"    
#&gt; [45] "Lasiorhinus_latifrons"   </div><div class='input'><span class='co'># Example2:</span>
<span class='co'># Match data and phy based on model formula:</span>
<span class='no'>comp.data2</span> <span class='kw'>&lt;-</span> <span class='fu'>match_dataphy</span>(<span class='no'>gestaLen</span> ~ <span class='no'>adultMass</span>, <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>alien</span>$<span class='no'>data</span>, <span class='no'>alien</span>$<span class='no'>phy</span>)</div><div class='output co'>#&gt; <span class='warning'>Warning: NA's in response or predictor, rows with NA's were removed</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Some phylo tips do not match species in data (this can be due to NA removal) species were dropped from phylogeny or data</span></div><div class='output co'>#&gt; <span class='message'>Used dataset has  84  species that match data and phylogeny</span></div><div class='input'><span class='co'># Check data (missing data on variables not included in the formula are preserved)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span>(<span class='no'>comp.data2</span>$<span class='no'>data</span>)</div><div class='output co'>#&gt;                                     family adultMass gestaLen homeRange
#&gt; Tachyglossus_aculeatus      Tachyglossidae  4020.767   28.375 0.9991117
#&gt; Ornithorhynchus_anatinus Ornithorhynchidae  1458.208   15.000 0.1120000
#&gt; Ondatra_zibethicus              Cricetidae  1135.014   27.100 0.0044500
#&gt; Mesocricetus_auratus            Cricetidae    97.125   15.500        NA
#&gt; Castor_canadensis               Castoridae 18085.634  110.000        NA
#&gt; Myocastor_coypus             Myocastoridae  6135.768  131.737 0.0376000
#&gt;                             SD_mass  SD_gesta   SD_range
#&gt; Tachyglossus_aculeatus   1218.29240  4.199500 0.79224190
#&gt; Ornithorhynchus_anatinus  180.81779  2.160000 0.04300000
#&gt; Ondatra_zibethicus        388.17479  3.333300 0.00000000
#&gt; Mesocricetus_auratus       12.52913  0.496000         NA
#&gt; Castor_canadensis        2875.61581 13.090000         NA
#&gt; Myocastor_coypus          546.08335  3.425162 0.01567712</div><div class='input'><span class='co'># Check phy:</span>
<span class='no'>comp.data2</span>$<span class='no'>phy</span></div><div class='output co'>#&gt; 101 phylogenetic trees</div><div class='input'><span class='co'># See species dropped from phy or data:</span>
<span class='no'>comp.data2</span>$<span class='no'>dropped</span></div><div class='output co'>#&gt;  [1] "Chinchilla_lanigera"      "Marmota_bobak"           
#&gt;  [3] "Tamias_townsendii"        "Atlantoxerus_getulus"    
#&gt;  [5] "Sciurus_niger"            "Sciurus_aureogaster"     
#&gt;  [7] "Lycalopex_griseus"        "Felis_catus"             
#&gt;  [9] "Pseudocheirus_peregrinus" "Petrogale_lateralis"     </div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#details">Details</a></li>
      <li><a href="#note">Note</a></li>
      <li><a href="#references">References</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    <p>Caterina Penone &amp; Gustavo Paterno</p>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Gustavo Paterno, Gijsbert Werner, Caterina Penone.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


