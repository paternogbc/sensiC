<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Influential clade detection - Phylogenetic signal — clade_physig • sensiPhy</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Influential clade detection - Phylogenetic signal — clade_physig" />
<meta property="og:description" content="Estimate the influence of clade removal on phylogenetic signal estimates" />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">sensiPhy</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.8.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/sensiPhy_vignette.html">sensiPhy: R-package for sensitivity analysis in phylogenetic comparative methods.</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/paternogbc/sensiPhy">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Influential clade detection - Phylogenetic signal</h1>
    <small class="dont-index">Source: <a href='https://github.com/paternogbc/sensiPhy/blob/master/R/clade_physig.R'><code>R/clade_physig.R</code></a></small>
    <div class="hidden name"><code>clade_physig.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Estimate the influence of clade removal on phylogenetic signal estimates</p>
    </div>

    <pre class="usage"><span class='fu'>clade_physig</span>(
  <span class='no'>trait.col</span>,
  <span class='no'>data</span>,
  <span class='no'>phy</span>,
  <span class='no'>clade.col</span>,
  <span class='kw'>n.species</span> <span class='kw'>=</span> <span class='fl'>5</span>,
  <span class='kw'>n.sim</span> <span class='kw'>=</span> <span class='fl'>100</span>,
  <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"K"</span>,
  <span class='kw'>track</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='no'>...</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>trait.col</th>
      <td><p>The name of a column in the provided data frame with trait 
to be analyzed  (e.g. "Body_mass").</p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p>Data frame containing species traits with row names matching tips
in <code>phy</code>.</p></td>
    </tr>
    <tr>
      <th>phy</th>
      <td><p>A phylogeny (class 'phylo') matching <code>data</code>.</p></td>
    </tr>
    <tr>
      <th>clade.col</th>
      <td><p>The column in the provided data frame which specifies the
clades (a character vector with clade names).</p></td>
    </tr>
    <tr>
      <th>n.species</th>
      <td><p>Minimum number of species in a clade for the clade to be
included in the leave-one-out deletion analysis. Default is <code>5</code>.</p></td>
    </tr>
    <tr>
      <th>n.sim</th>
      <td><p>Number of simulations for the randomization test.</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>Method to compute signal: can be "K" or "lambda".</p></td>
    </tr>
    <tr>
      <th>track</th>
      <td><p>Print a report tracking function progress (default = TRUE)</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Further arguments to be passed to <code><a href='https://rdrr.io/pkg/phytools/man/phylosig.html'>phylosig</a></code></p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>The function <code>clade_physig</code> returns a list with the following
components:</p>
<p><code>trait.col</code>: Column name of the trait analysed</p>
<p><code>full.data.estimates</code>: Phylogenetic signal estimate (K or lambda)
and the P value (for the full data).</p>
<p><code>sensi.estimates</code>: A data frame with all simulation
estimates. Each row represents a deleted clade. Columns report the calculated
phylogenetic signal (K or lambda) (<code>estimate</code>), difference between simulation
signal and full data signal (<code>DF</code>), the percentage of change
in signal compared to the full data estimate (<code>perc</code>) and 
p-value of the phylogenetic signal with the reduced data (<code>pval</code>).</p>
<p><code>null.dist</code>: A data frame with estimates for the null distribution
of phylogenetic signal for all clades analysed.</p>
<p><code>data</code>: Original full dataset.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This function sequentially removes one clade at a time, estimates phylogenetic
signal (K or lambda) using <code><a href='https://rdrr.io/pkg/phytools/man/phylosig.html'>phylosig</a></code> and stores the
results. The impact of a specific clade on signal estimates is calculated by the
comparison between the full data (with all species) and reduced data estimates
(without the species belonging to a clade).</p>
<p>To account for the influence of the number of species on each 
clade (clade sample size), this function also estimate a null distribution of signal estimates
expected by the removal of the same number of species as in a given clade. This is done by estimating
phylogenetic signal without the same number of species in the given clade. 
 The number of simulations to be performed is set by 'n.sim'. To test if the 
 clade influence differs from the null expectation for a clade of that size, 
 a randomization test can be performed using 'summary(x)'.</p>
<p>Output can be visualised using <code>sensi_plot</code>.</p>
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>The argument "se" from <code><a href='https://rdrr.io/pkg/phytools/man/phylosig.html'>phylosig</a></code> is not available in this function. Use the 
argument "V" instead with <code><a href='intra_physig.html'>intra_physig</a></code> to indicate the name of the column containing the standard 
deviation or the standard error of the trait variable instead.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Paterno, G. B., Penone, C. Werner, G. D. A. 
<a href='http://doi.wiley.com/10.1111/2041-210X.12990'>sensiPhy: 
An r-package for sensitivity analysis in phylogenetic 
comparative methods.</a> Methods in Ecology and Evolution 
2018, 9(6):1461-1467</p>
<p>Blomberg, S. P., T. Garland Jr., A. R. Ives (2003) 
Testing for phylogenetic signal in comparative data: 
Behavioral traits are more labile. Evolution, 57, 717-745.</p>
<p>Pagel, M. (1999) Inferring the historical patterns of biological evolution. 
Nature, 401, 877-884.</p>
<p>Kamilar, J. M., &amp; Cooper, N. (2013). Phylogenetic signal in primate behaviour,
 ecology and life history. Philosophical Transactions of the Royal Society 
 B: Biological Sciences, 368: 20120341.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='https://rdrr.io/pkg/phytools/man/phylosig.html'>phylosig</a></code>, 
<code><a href='clade_phylm.html'>clade_phylm</a></code>,<code><a href='sensi_plot.html'>sensi_plot</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>alien</span>)
<span class='no'>alien.data</span><span class='kw'>&lt;-</span><span class='no'>alien</span>$<span class='no'>data</span>
<span class='no'>alien.phy</span><span class='kw'>&lt;-</span><span class='no'>alien</span>$<span class='no'>phy</span>
<span class='co'># Logtransform data</span>
<span class='no'>alien.data</span>$<span class='no'>logMass</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span>(<span class='no'>alien.data</span>$<span class='no'>adultMass</span>)
<span class='co'># Run sensitivity analysis:</span>
<span class='no'>clade</span> <span class='kw'>&lt;-</span> <span class='fu'>clade_physig</span>(<span class='kw'>trait.col</span> <span class='kw'>=</span> <span class='st'>"logMass"</span>, <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>alien.data</span>, <span class='kw'>n.sim</span> <span class='kw'>=</span> <span class='fl'>20</span>,
                 <span class='kw'>phy</span> <span class='kw'>=</span> <span class='no'>alien.phy</span><span class='kw'>[[</span><span class='fl'>1</span>]], <span class='kw'>clade.col</span> <span class='kw'>=</span> <span class='st'>"family"</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"K"</span>)</div><div class='output co'>#&gt; <span class='warning'>Warning: NA's in response or predictor, rows with NA's were removed</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Some phylo tips do not match species in data (this can be due to NA removal) species were dropped from phylogeny or data</span></div><div class='output co'>#&gt; <span class='message'>Used dataset has  92  species that match data and phylogeny</span></div><div class='output co'>#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |=                                                                     |   1%  |                                                                              |=                                                                     |   2%  |                                                                              |==                                                                    |   3%  |                                                                              |===                                                                   |   4%  |                                                                              |====                                                                  |   5%  |                                                                              |====                                                                  |   6%  |                                                                              |=====                                                                 |   7%  |                                                                              |======                                                                |   8%  |                                                                              |======                                                                |   9%  |                                                                              |=======                                                               |  10%  |                                                                              |========                                                              |  11%  |                                                                              |========                                                              |  12%  |                                                                              |=========                                                             |  13%  |                                                                              |==========                                                            |  14%  |                                                                              |==========                                                            |  15%  |                                                                              |===========                                                           |  16%  |                                                                              |============                                                          |  17%  |                                                                              |=============                                                         |  18%  |                                                                              |=============                                                         |  19%  |                                                                              |==============                                                        |  20%  |                                                                              |===============                                                       |  21%  |                                                                              |===============                                                       |  22%  |                                                                              |================                                                      |  23%  |                                                                              |=================                                                     |  24%  |                                                                              |==================                                                    |  25%  |                                                                              |==================                                                    |  26%  |                                                                              |===================                                                   |  27%  |                                                                              |====================                                                  |  28%  |                                                                              |====================                                                  |  29%  |                                                                              |=====================                                                 |  30%  |                                                                              |======================                                                |  31%  |                                                                              |======================                                                |  32%  |                                                                              |=======================                                               |  33%  |                                                                              |========================                                              |  34%  |                                                                              |========================                                              |  35%  |                                                                              |=========================                                             |  36%  |                                                                              |==========================                                            |  37%  |                                                                              |===========================                                           |  38%  |                                                                              |===========================                                           |  39%  |                                                                              |============================                                          |  40%  |                                                                              |=============================                                         |  41%  |                                                                              |=============================                                         |  42%  |                                                                              |==============================                                        |  43%  |                                                                              |===============================                                       |  44%  |                                                                              |================================                                      |  45%  |                                                                              |================================                                      |  46%  |                                                                              |=================================                                     |  47%  |                                                                              |==================================                                    |  48%  |                                                                              |==================================                                    |  49%  |                                                                              |===================================                                   |  50%  |                                                                              |====================================                                  |  51%  |                                                                              |====================================                                  |  52%  |                                                                              |=====================================                                 |  53%  |                                                                              |======================================                                |  54%  |                                                                              |======================================                                |  55%  |                                                                              |=======================================                               |  56%  |                                                                              |========================================                              |  57%  |                                                                              |=========================================                             |  58%  |                                                                              |=========================================                             |  59%  |                                                                              |==========================================                            |  60%  |                                                                              |===========================================                           |  61%  |                                                                              |===========================================                           |  62%  |                                                                              |============================================                          |  63%  |                                                                              |=============================================                         |  64%  |                                                                              |==============================================                        |  65%  |                                                                              |==============================================                        |  66%  |                                                                              |===============================================                       |  67%  |                                                                              |================================================                      |  68%  |                                                                              |================================================                      |  69%  |                                                                              |=================================================                     |  70%  |                                                                              |==================================================                    |  71%  |                                                                              |==================================================                    |  72%  |                                                                              |===================================================                   |  73%  |                                                                              |====================================================                  |  74%  |                                                                              |====================================================                  |  75%  |                                                                              |=====================================================                 |  76%  |                                                                              |======================================================                |  77%  |                                                                              |=======================================================               |  78%  |                                                                              |=======================================================               |  79%  |                                                                              |========================================================              |  80%  |                                                                              |=========================================================             |  81%  |                                                                              |=========================================================             |  82%  |                                                                              |==========================================================            |  83%  |                                                                              |===========================================================           |  84%  |                                                                              |============================================================          |  85%  |                                                                              |============================================================          |  86%  |                                                                              |=============================================================         |  87%  |                                                                              |==============================================================        |  88%  |                                                                              |==============================================================        |  89%  |                                                                              |===============================================================       |  90%  |                                                                              |================================================================      |  91%  |                                                                              |================================================================      |  92%  |                                                                              |=================================================================     |  93%  |                                                                              |==================================================================    |  94%  |                                                                              |==================================================================    |  95%  |                                                                              |===================================================================   |  96%  |                                                                              |====================================================================  |  97%  |                                                                              |===================================================================== |  98%  |                                                                              |===================================================================== |  99%  |                                                                              |======================================================================| 100%</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>clade</span>)</div><div class='output co'>#&gt; $`Full data: K phylogenetic signal estimate`
#&gt;     Trait N.species  estimate  Pval
#&gt; 1 logMass        92 0.8833355 0.001
#&gt; 
#&gt; $`Summary by clade removal`
#&gt;   clade.removed N.species  estimate      DIF.est Change (%)  Pval
#&gt; 1       Bovidae        15 0.7236622 -0.159673335       18.1 0.001
#&gt; 2      Cervidae        12 0.7700364 -0.113299161       12.8 0.001
#&gt; 3  Macropodidae         8 0.9608746  0.077539057        8.8 0.001
#&gt; 4    Mustelidae         6 0.9348294  0.051493828        5.8 0.001
#&gt; 5     Sciuridae         7 0.8923417  0.009006148        1.0 0.001
#&gt;   m.null.estimate Pval.randomization
#&gt; 1       0.9179747               0.00
#&gt; 2       0.8977280               0.00
#&gt; 3       0.8917848               0.05
#&gt; 4       0.8877609               0.15
#&gt; 5       0.8857689               0.35
#&gt; </div><div class='input'><span class='fu'><a href='sensi_plot.html'>sensi_plot</a></span>(<span class='no'>clade</span>, <span class='st'>"Bovidae"</span>)</div><div class='output co'>#&gt; <span class='warning'>Warning: Use of `nd$estimate` is discouraged. Use `estimate` instead.</span></div><div class='img'><img src='clade_physig-1.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'><a href='sensi_plot.html'>sensi_plot</a></span>(<span class='no'>clade</span>, <span class='st'>"Sciuridae"</span>)</div><div class='output co'>#&gt; <span class='warning'>Warning: Use of `nd$estimate` is discouraged. Use `estimate` instead.</span></div><div class='img'><img src='clade_physig-2.png' alt='' width='700' height='433' /></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#details">Details</a></li>
      <li><a href="#note">Note</a></li>
      <li><a href="#references">References</a></li>
      <li><a href="#see-also">See also</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    <p>Gustavo Paterno</p>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Gustavo Paterno, Gijsbert Werner, Caterina Penone.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


